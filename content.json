{"pages":[],"posts":[{"title":"C++å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­std::futureçš„ä½¿ç”¨","text":"æœ€è¿‘ä¸€ç›´åœ¨æå¤šçº¿ç¨‹ï¼ŒC++çš„åº•å­è¾ƒçƒ‚ï¼Œç›´æ¥ç”¨.detach()æ–¹æ³•åˆ›å»ºçº¿ç¨‹ï¼Œæ— æ³•ä½¿è¾“å…¥é¡ºåºå’Œè¾“å‡ºé¡ºåºåŒæ­¥ï¼Œè€Œä¸”è¾“å…¥æ•°æ®åœ¨ä¸æ–­çš„äº§ç”Ÿï¼Œç±»ä¼¼ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜ï¼Œä¸æ–­çš„åˆ›å»ºæ–°çº¿ç¨‹ä¼šæµªè´¹æ—¶é—´ï¼Œæ‰€ä»¥æƒ³åˆ°ç”¨çº¿ç¨‹æ± çš„æ–¹æ³•ã€‚ std::futureæ˜¯ä¸€ä¸ªç±»æ¨¡æ¿(class template)ï¼Œå…¶å¯¹è±¡å­˜å‚¨æœªæ¥çš„å€¼ï¼Œä¸€ä¸ªstd::futureå¯¹è±¡åœ¨å†…éƒ¨å­˜å‚¨ä¸€ä¸ªå°†æ¥ä¼šè¢«èµ‹å€¼çš„å€¼ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªè®¿é—®è¯¥å€¼çš„æœºåˆ¶ï¼Œé€šè¿‡get()æˆå‘˜å‡½æ•°å®ç°ã€‚ä½†å¦‚æœæœ‰äººè§†å›¾åœ¨get()å‡½æ•°å¯ç”¨ä¹‹å‰é€šè¿‡å®ƒæ¥è®¿é—®ç›¸å…³çš„å€¼ï¼Œé‚£ä¹ˆget()å‡½æ•°å°†ä¼šé˜»å¡ï¼Œç›´åˆ°è¯¥å€¼å¯ç”¨ã€‚æ¥æºï¼šhttps://blog.csdn.net/lijinqi1987/article/details/78507623 æˆ‘ç†è§£è¿™æ®µè¯çš„æ„æ€å°±æ˜¯å› ä¸ºå¤šçº¿ç¨‹è¾“å‡ºæ²¡åŠæ³•æ§åˆ¶è¾“å‡ºçš„é¡ºåºï¼Œé‚£ä¹ˆfutureå°±ä¸ºæ‰€æœ‰ä¼šæœ‰è¾“å‡ºçš„ä½ç½®æ”¾ä¸€ä¸ªå ä½ç¬¦ï¼Œè®¤å®šè¿™ä¸ªä½ç½®ä¼šæœ‰ä¸€ä¸ªè¾“å‡ºï¼Œä½†æ˜¯å…·ä½“ä»€ä¹ˆæ—¶é—´ä¼šæœ‰ä¸ç¡®å®šã€‚ æµ‹è¯•ç»“æœï¼š æ¥æºï¼šhttps://github.com/progschj/ThreadPool GitHub2kå¤šstarçš„ä¸€ä¸ªçº¿ç¨‹æ± çš„é¡¹ç›®ï¼Œæ”¹äº†ä¸€ä¸‹exampleï¼Œçœ‹è¾“å‡ºæ›´ç›´è§‚ä¸€äº›ã€‚ è¯è¯´æ˜¨å¤©æœ‰ä¸ªå°ç ´ç«™çš„åå°æºç è¢«pushä¸Šæ¥äº†ï¼Œgolangçš„æ•™ç¨‹å¯èƒ½è¦ç«äº†ï¼Œpushä¸€æ—¶çˆ½ï¼Œç‰¢é¥­åƒåˆ°è€ï¼ŒèŒä¸šé“å¾·è¿˜æ˜¯è¦æœ‰çš„ã€‚ 123456hello hello hello hello hello hello hello hello hello hello 1 2 0 1 2 2 0 1 0 0 world 1world 2 world 0 world 1 hello 2 world 2 world 2 hello 0 hello 3 world 0 world 0 hello 1hello 3 hello 0 hello 1 hello 2 world 0 world 1 hello 1 hello 2 world 2 world 0 hello 3 world 3 world 1 world 3 world 0world 1 world 2 world 2 world 1 world 30 1 2 0 1 2 0 1 2 0 1 2 3 0 1 2 3 0 1 2 3 å¯ä»¥å‘ç°ï¼Œåˆ›å»ºäº†10ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹çš„æ‰§è¡Œæ˜¯å¹¶è¡Œçš„ï¼Œä½†æ˜¯è¾“å‡ºçš„ç»“æœå’Œè¾“å‡ºçš„é¡ºåºæ˜¯ä¸€æ ·çš„ã€‚ å®Œæ•´ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899//*****************ThreadPool.h**********************#ifndef THREAD_POOL_H#define THREAD_POOL_H#include &lt;vector&gt;#include &lt;queue&gt;#include &lt;memory&gt;#include &lt;thread&gt;#include &lt;mutex&gt;#include &lt;condition_variable&gt;#include &lt;future&gt;#include &lt;functional&gt;#include &lt;stdexcept&gt;class ThreadPool {public: ThreadPool(size_t); template&lt;class F, class... Args&gt; auto enqueue(F&amp;&amp; f, Args&amp;&amp;... args) -&gt; std::future&lt;typename std::result_of&lt;F(Args...)&gt;::type&gt;; ~ThreadPool();private: // need to keep track of threads so we can join them std::vector&lt; std::thread &gt; workers; // the task queue std::queue&lt; std::function&lt;void()&gt; &gt; tasks; // synchronization std::mutex queue_mutex; std::condition_variable condition; bool stop;}; // the constructor just launches some amount of workersinline ThreadPool::ThreadPool(size_t threads) : stop(false){ for(size_t i = 0;i&lt;threads;++i) workers.emplace_back( [this] { for(;;) { std::function&lt;void()&gt; task; { std::unique_lock&lt;std::mutex&gt; lock(this-&gt;queue_mutex); this-&gt;condition.wait(lock, [this]{ return this-&gt;stop || !this-&gt;tasks.empty(); }); if(this-&gt;stop &amp;&amp; this-&gt;tasks.empty()) return; task = std::move(this-&gt;tasks.front()); this-&gt;tasks.pop(); } task(); } } );}// add new work item to the pooltemplate&lt;class F, class... Args&gt;auto ThreadPool::enqueue(F&amp;&amp; f, Args&amp;&amp;... args) -&gt; std::future&lt;typename std::result_of&lt;F(Args...)&gt;::type&gt;{ using return_type = typename std::result_of&lt;F(Args...)&gt;::type; auto task = std::make_shared&lt; std::packaged_task&lt;return_type()&gt; &gt;( std::bind(std::forward&lt;F&gt;(f), std::forward&lt;Args&gt;(args)...) ); std::future&lt;return_type&gt; res = task-&gt;get_future(); { std::unique_lock&lt;std::mutex&gt; lock(queue_mutex); // don't allow enqueueing after stopping the pool if(stop) throw std::runtime_error(\"enqueue on stopped ThreadPool\"); tasks.emplace([task](){ (*task)(); }); } condition.notify_one(); return res;}// the destructor joins all threadsinline ThreadPool::~ThreadPool(){ { std::unique_lock&lt;std::mutex&gt; lock(queue_mutex); stop = true; } condition.notify_all(); for(std::thread &amp;worker: workers) worker.join();}#endif 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253//*****************example.cpp**********************#include &lt;iostream&gt;#include &lt;vector&gt;#include &lt;chrono&gt;#include \"ThreadPool.h\"std::vector&lt;std::vector&lt;int&gt;&gt; a;int main(){ ThreadPool pool(10); //create a &lt;future&gt; vector to wait the output std::vector&lt; std::future&lt;std::vector&lt;int&gt;&gt; &gt; results; std::vector&lt;int&gt; batch = {3, 3, 3}; int m = 3; for (int b = 0; b &lt; batch.size(); b++) { if (m &gt; 0) { batch.push_back(4); } for (int i = 0; i &lt; batch[b]; i++) { results.emplace_back( pool.enqueue([i] { std::vector&lt;int&gt; res = {i}; std::cout &lt;&lt; \"hello \" &lt;&lt; i &lt;&lt; \" \"; std::this_thread::sleep_for(std::chrono::seconds(1)); std::cout &lt;&lt; \"world \" &lt;&lt; i &lt;&lt; \" \"; return res; })); } m--; } //get output for(auto &amp;&amp; result: results) a.emplace_back(result.get()); std::cout &lt;&lt; std::endl; std::cout &lt;&lt; std::endl; //after get all output, print it for (int i = 0; i &lt; a.size(); i++) { for (int j = 0; j &lt; a[i].size(); j++) std::cout &lt;&lt; a[i][j] &lt;&lt; \" \"; } system(\"pause\"); return 0;}","link":"/2019/04/22/C++å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­futureçš„ä½¿ç”¨/"},{"title":"C++æ ˆå®ç°åˆ†éš”ç¬¦çš„åŒ¹é…","text":"æ ˆæ˜¯ä¸€ç§åè¿›å…ˆå‡º(LIFO)çš„çº¿æ€§æ•°æ®ç»“æ„ã€‚ æ ˆé€‚ç”¨äºæ•°æ®å­˜å‚¨åä»¥ç›¸åçš„é¡ºåºæ¥æ£€ç´¢çš„æƒ…å†µã€‚ç«™çš„ä¸€ä¸ªåº”ç”¨æ˜¯åœ¨ç¨‹åºä¸­åŒ¹é…åˆ†éš”ç¬¦ã€‚ åœ¨C++ç¨‹åºä¸­å­˜åœ¨ä¸‹åˆ—åˆ†éš”ç¬¦ï¼šåœ†æ‹¬å·â€(â€œå’Œâ€)â€œã€æ–¹æ‹¬å·â€[â€œå’Œâ€]â€œã€èŠ±æ‹¬å·â€{â€œå’Œâ€}â€œã€æ³¨é‡Šåˆ†éš”ç¬¦â€/*â€œå’Œâ€*/â€œ æ ˆçš„æ“ä½œï¼š clear()â€”â€”æ¸…ç©ºæ ˆã€‚ isEmpty()â€”â€”åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©ºã€‚ push(el)â€”â€”å°†å…ƒç´ elæ”¾åˆ°æ ˆçš„é¡¶éƒ¨ã€‚ pop()â€”â€”å¼¹å‡ºæ ˆé¡¶éƒ¨çš„å…ƒç´ ã€‚ topEL()â€”â€”è·å–æ ˆé¡¶éƒ¨çš„å…ƒç´ ï¼Œä¸åˆ é™¤ã€‚ genStack.h 1234567891011121314151617181920212223242526272829303132333435363738394041424344//******************* genStack.h ************************// generic class for vector implenmentation of stack#ifndef STACK#define STACK#include &lt;vector&gt;using namespace std;template&lt;class T, int capacity = 30&gt;class Stack {public: Stack() { pool.reserve(capacity); } void clear() { pool.clear(); } bool isEmpty() const { return pool.empty(); } T&amp; topEl() { return pool.back(); } T pop() { T el = pool.back(); pool.pop_back(); return el; } void push(const T&amp; el) { pool.push_back(el); }private: vector&lt;T&gt; pool;};#endif genStack.cpp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354//******************* genStack.h ************************//ç”¨æ ˆå®ç°åˆ†éš”ç¬¦çš„åŒ¹é…#include &lt;iostream&gt;#include &quot;genStack.h&quot;#include &lt;string&gt;using namespace std;int main() { string str = &quot;s=t[5]+u/(v*(w+y))&quot;; Stack&lt;char&gt; s1; for (int i = 0; i &lt; str.size(); i++) { //æ³¨æ„å•å¼•å·å’ŒåŒå¼•å·çš„ä½¿ç”¨ï¼ï¼ï¼ if (str[i] == &apos;(&apos; || str[i] == &apos;[&apos; || str[i] == &apos;{&apos;) { s1.push(str[i]); //cout &lt;&lt; &quot;topEL: &quot; &lt;&lt; s1.topEl() &lt;&lt; endl; } else if (str[i] == &apos;)&apos; || str[i] == &apos;]&apos; || str[i] == &apos;}&apos;) { if ((s1.topEl()==&apos;(&apos; &amp;&amp; str[i]==&apos;)&apos;) || (s1.topEl()==&apos;[&apos; &amp;&amp; str[i]==&apos;]&apos;) || (s1.topEl()==&apos;{&apos; &amp;&amp; str[i]==&apos;}&apos;)) { s1.pop(); } else { cout &lt;&lt; &quot;error!&quot; &lt;&lt; endl; system(&quot;pause&quot;); return 0; } } else if (str[i] == &apos;/&apos;) { if (str[i + 1] == &apos;*&apos;) { for (int j = i; j &lt; str.size(); j++) { if (str[j] == &apos;*&apos; &amp;&amp; str[j + 1] == &apos;/&apos;) { i = j + 1; break; } else if (j == str.size()-1) { cout &lt;&lt; &quot;&apos;/*&apos; can not match &apos;*/&apos;&quot; &lt;&lt; endl; system(&quot;pause&quot;); return 0; } } } else continue; } } if (s1.isEmpty()) cout &lt;&lt; &quot;success!&quot; &lt;&lt; endl; else cout &lt;&lt; &quot;failed!&quot; &lt;&lt; endl; system(&quot;pause&quot;); return 0;}","link":"/2019/04/08/C++æ ˆå®ç°åˆ†éš”ç¬¦çš„åŒ¹é…/"},{"title":"Leetcode-Two Sum","text":"Given an array of integers, return indices of the two numbers such that they add up to a specific target. You may assume that each input would have exactly one solution, and you may not use the same element twice. Example: 1234Given nums = [2, 7, 11, 15], target = 9,Because nums[0] + nums[1] = 2 + 7 = 9,return [0, 1]. Solution: æˆ‘çš„è§£å†³æ–¹æ¡ˆï¼š 123456789101112131415161718class Solution {public: vector&lt;int&gt; twoSum(vector&lt;int&gt;&amp; nums, int target) { vector&lt;int&gt; index; for (int i = 0; i &lt; nums.size(); i++) { for (int j = i; j &lt; nums.size(); j++) { if (i != j &amp;&amp; (nums[i] + nums[j] == target)) { index.push_back(i); index.push_back(j); } } } return index; }}; 12Runtime: 384 ms, faster than 5.00% of C++ online submissions for Two Sum.Memory Usage: 9.4 MB, less than 90.00% of C++ online submissions for Two Sum. ç®—æ³•æ¯”è¾ƒè ¢ï¼Œå•çº¯çš„éå†ï¼Œé•¿è·¯æ¼«æ¼«ï¼Œè¿˜è¦å¥½å¥½å­¦ã€‚ Top Voted Solutionï¼š The basic idea is to maintain a hash table for each element num in nums, using num as key and its index (0-based) as value. For each num, search for target - num in the hash table. If it is found and is not the same element as num, then we are done. 12345678910111213class Solution {public: vector&lt;int&gt; twoSum(vector&lt;int&gt;&amp; nums, int target) { unordered_map&lt;int, int&gt; indices; for (int i = 0; i &lt; nums.size(); i++) { if (indices.find(target - nums[i]) != indices.end()) { return {indices[target - nums[i]], i}; } indices[nums[i]] = i; } return {}; }};","link":"/2019/03/25/Leetcode001-Two Sum/"},{"title":"Leetcode-Reverse Integer","text":"Given a 32-bit signed integer, reverse digits of an integer. Example 1: 12Input: 123Output: 321 Example 2: 12Input: -123Output: -321 Example 3: 12Input: 120Output: 21 Note:Assume we are dealing with an environment which could only store integers within the 32-bit signed integer range: $[âˆ’2^{31}, 2^{31 âˆ’ 1}]$. For the purpose of this problem, assume that your function returns 0 when the reversed integer overflows. çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªç‰¹åˆ«ç®€å•çš„é—®é¢˜ï¼Œç¬¬ä¸€æƒ³æ³•ä¹Ÿæ˜¯ä¸ªé‡è·¯å­ï¼Œå…ˆæŠŠæ•´å‹è½¬å­—ç¬¦ä¸²ï¼Œå†å°†å­—ç¬¦ä¸²é€†åºæ’åˆ—ä¸€ä¸‹ï¼Œåœ¨è½¬æ¢å›æ•´å‹ï¼Œæ„Ÿè§‰ä¸å¦¥ã€‚ ç®—æ³•æ€æƒ³ç‰¹åˆ«ç®€å•ï¼Œ 1res = res * 10 + x % 10; å…¶å®æˆ‘æ²¡æƒ³åˆ°ï¼Œçœ‹äº†åˆ«äººçš„ç­”æ¡ˆæ‰é¢†æ‚Ÿã€‚ è¿™é‡Œå¾ˆå®¹æ˜“æ‡‚ï¼Œä½†æ˜¯æ•°æ®æº¢å‡ºæ˜¯ä¸ªå¤§é—®é¢˜ï¼Œæˆ‘ä»¥ä¸ºä¸€å¥ 1x &gt;= INT_MIN || x &lt;= INT_MAX å°±å¯ä»¥è§£å†³äº†ï¼Œtoo young, too naive. æœç„¶è¦å·å·çœ‹ç­”æ¡ˆäº†ã€‚ æ ¸å¿ƒæ€æƒ³ï¼š pop = x % 10, If $temp = res\\times10 + popâ€‹$ causes overflow, then it must be that $res\\geq\\frac{INTMAX}{10}â€‹$ If $res\\geq\\frac{INTMAX}{10}$, then $temp = res\\times10 + pop$ is guaranteed to overflow If $res==\\frac{INTMAX}{10}$, then $temp = res\\times10 + pop$ will overflow if and only if $pop &gt; 7$ 1234567891011121314class Solution {public: int reverse(int x) { int rev = 0; while (x != 0) { int pop = x % 10; x /= 10; if (rev &gt; INT_MAX/10 || (rev == INT_MAX / 10 &amp;&amp; pop &gt; 7)) return 0; if (rev &lt; INT_MIN/10 || (rev == INT_MIN / 10 &amp;&amp; pop &lt; -8)) return 0; rev = rev * 10 + pop; } return rev; }};","link":"/2019/03/26/Leetcode007-Reverse Integer/"},{"title":"Leetcode-Palindrome Number","text":"Determine whether an integer is a palindrome. An integer is a palindrome when it reads the same backward as forward. Example 1: 12Input: 121Output: true Example 2: 123Input: -121Output: falseExplanation: From left to right, it reads -121. From right to left, it becomes 121-. Therefore it is not a palindrome. Example 3: 123Input: 10Output: falseExplanation: Reads 01 from right to left. Therefore it is not a palindrome. Follow up: Coud you solve it without converting the integer to a string? ç®—æ³•æ€æƒ³å’Œç¬¬7é¢˜å·®ä¸å¤šï¼Œè€Œä¸”è¯´äº†ä¸è®©ç”¨stringï¼Œå°±æ˜¯ç¬¬7é¢˜ä¹‹ååŠ ä¸ªåˆ¤æ–­ï¼Œæ„Ÿè§‰è‡ªå·±åœ¨å·æ‡’ï¼Œä½†æ˜¯è¿˜æ˜¯æƒ³äº†å¥½é•¿æ—¶é—´æ‰æƒ³å‡ºæ¥ã€‚ Solutionï¼š 1234567891011121314151617181920class Solution {public: bool isPalindrome(int x) { int res = 0, tmp = x; if (x &lt; 0) return false; while (tmp != 0) { int pop = tmp % 10; tmp /= 10; if (res &gt; INT_MAX/10 || (res == INT_MAX / 10 &amp;&amp; pop &gt; 7)) return 0; if (res &lt; INT_MIN/10 || (res == INT_MIN / 10 &amp;&amp; pop &lt; -8)) return 0; res = res * 10 + pop; } if (res == x) return true; else return false; }}; Time Submitted Status Runtime Memory Language a few seconds ago Accepted 32 ms 8 MB cpp æœ€è¿‘è´Ÿèƒ½é‡æœ‰ç‚¹å¤šï¼Œéœ€è¦å¿ƒçµé¸¡æ±¤é€ä¸€é€ï¼Œæœ€å¥½æ˜¯å–å®Œèƒ½ä¸Šå¤´çš„é‚£ç§ã€‚","link":"/2019/03/28/Leetcode009-Palindrome Number/"},{"title":"Leetcode-Roman to Integer","text":"Roman numerals are represented by seven different symbols: I, V, X, L, C, D and M. 12345678Symbol ValueI 1V 5X 10L 50C 100D 500M 1000 For example, two is written as II in Roman numeral, just two oneâ€™s added together. Twelve is written as, XII, which is simply X + II. The number twenty seven is written as XXVII, which is XX + V + II. Roman numerals are usually written largest to smallest from left to right. However, the numeral for four is not IIII. Instead, the number four is written as IV. Because the one is before the five we subtract it making four. The same principle applies to the number nine, which is written as IX. There are six instances where subtraction is used: I can be placed before V (5) and X (10) to make 4 and 9. X can be placed before L (50) and C (100) to make 40 and 90. C can be placed before D (500) and M (1000) to make 400 and 900. Given a roman numeral, convert it to an integer. Input is guaranteed to be within the range from 1 to 3999. Example 1: 12Input: &quot;III&quot;Output: 3 Example 2: 12Input: &quot;IV&quot;Output: 4 Example 3: 12Input: &quot;IX&quot;Output: 9 Example 4: 123Input: &quot;LVIII&quot;Output: 58Explanation: L = 50, V= 5, III = 3. Example 5: 123Input: &quot;MCMXCIV&quot;Output: 1994Explanation: M = 1000, CM = 900, XC = 90 and IV = 4. æœ€å¼€å§‹æƒ³ç”¨æ¯ç§æƒ…å†µéƒ½å†™ä¸€éï¼Œè™½ç„¶ä¼šçš„ä¸å¤šï¼Œä½†è¿˜æ˜¯å«Œéº»çƒ¦ï¼Œæƒ³åˆ°äº†Pythonä¸­çš„ç”¨ä¸¤ä¸ªlistå»å¯¹åº”ç›¸åŒçš„ç´¢å¼•çš„ä¸åŒç±»å‹ï¼Œæ‰€ä»¥ç”¨æ•°ç»„è€å¯¹åº”ä¸åŒçš„ç½—é©¬ç¬¦å·ã€‚ Solutionï¼š 1234567891011121314151617181920212223242526272829class Solution {public: int romanToInt(string s) { int num[] = {1, 5, 10, 50, 100, 500, 1000}; string rom = &quot;IVXLCDM&quot;; vector&lt;int&gt; tmp; int res = 0; for (int i = 0; i &lt; s.size(); i++) { for (int j = 0; j &lt; 7; j++) { if (s[i] == rom[j]) tmp.push_back(num[j]); } } for (int i = 0; i &lt; tmp.size(); i++) { if (i == tmp.size() - 1 || tmp[i] &gt;= tmp[i + 1]) { res += tmp[i]; } else { res -= tmp[i]; } } return res; }}; if (i == tmp.size() - 1 || tmp[i] &gt;= tmp[i + 1])ï¼Œè¿™é‡Œæœ€å¼€å§‹æ˜¯if(tmp[i] &gt;= tmp[i + 1])ï¼Œå¤„ç†&quot;MCDLXXVI&quot;æ—¶æŠ¥é”™äº†ï¼Œè¾“å‡ºç»“æœå‘ç°æœ€åçš„Iå¹¶æ²¡æœ‰åŠ è¿›å»ï¼Œå¾ˆç¥å¥‡ï¼ŒåŸå› è¿˜æ²¡æ‰¾åˆ°ï¼Œå…ˆç•™ä¸ªå‘ã€‚ Time Submitted Status Runtime Memory Language a few seconds ago Accepted 20 ms 9 MB cpp","link":"/2019/03/29/Leetcode013-Roman to Integer/"},{"title":"Leetcode-Longest Common Prefix","text":"Write a function to find the longest common prefix string amongst an array of strings. If there is no common prefix, return an empty string &quot;&quot;. Example 1: 12Input: [&quot;flower&quot;,&quot;flow&quot;,&quot;flight&quot;]Output: &quot;fl&quot; Example 2: 123Input: [&quot;dog&quot;,&quot;racecar&quot;,&quot;car&quot;]Output: &quot;&quot;Explanation: There is no common prefix among the input strings. Note: All given inputs are in lowercase letters a-z. Solutionï¼š 1234567891011121314151617181920212223242526272829class Solution {public: string longestCommonPrefix(vector&lt;string&gt;&amp; strs) { if (strs.size() == 0) return \"\"; int minlen = INT_MAX; string res = \"\"; for (int i = 0; i &lt; strs.size(); i++) { if (strs[i].size() &lt; minlen) minlen = strs[i].size(); } for (int i = 0; i &lt; minlen; i++) { bool flag = true; for (int j = 0; j &lt; strs.size() - 1; j++) { if (strs[j][i] != strs[j + 1][i]) flag = false; } if (flag == true) res = res + strs[0][i]; else break; } return res; }}; æ²¡ä»€ä¹ˆäº®ç‚¹çš„å†™æ³•ã€‚ Time Submitted Status Runtime Memory Language a few seconds ago Accepted 8 ms 9.1 MB cpp","link":"/2019/03/31/Leetcode014-Longest Common Prefix/"},{"title":"Leetcode-Valid Parentheses","text":"ä¹‹å‰å°±çœ‹åˆ°è¿™é“é¢˜ï¼Œæ²¡æƒ³åˆ°å¥½çš„æ–¹æ³•ï¼Œæ­£å¥½æœ€è¿‘åœ¨ææ•°æ®ç»“æ„ï¼Œåˆ°æ ˆè¿™é‡Œä¸€ä¸ªåº”ç”¨å°±æ˜¯æ‹¬å·çš„åŒ¹é…ã€‚ Given a string containing just the characters '(', ')', '{', '}', '[' and ']', determine if the input string is valid. An input string is valid if: Open brackets must be closed by the same type of brackets. Open brackets must be closed in the correct order. Note that an empty string is also considered valid. Example 1: 12Input: &quot;()&quot;Output: true Example 2: 12Input: &quot;()[]{}&quot;Output: true Example 3: 12Input: &quot;(]&quot;Output: false Example 4: 12Input: &quot;([)]&quot;Output: false Example 5: 12Input: &quot;{[]}&quot;Output: true Solution: 123456789101112131415161718192021222324252627class Solution {public: bool isValid(string str) { stack&lt;char&gt; s1; for (int i = 0; i &lt; str.size(); i++) { if (str[i] == &apos;(&apos; || str[i] == &apos;[&apos; || str[i] == &apos;{&apos;) { s1.push(str[i]); } else if (str[i] == &apos;)&apos; || str[i] == &apos;]&apos; || str[i] == &apos;}&apos;) { if (s1.empty()) { return false; } else if ((s1.top()==&apos;(&apos; &amp;&amp; str[i]==&apos;)&apos;) || (s1.top()==&apos;[&apos; &amp;&amp; str[i]==&apos;]&apos;) || (s1.top()==&apos;{&apos; &amp;&amp; str[i]==&apos;}&apos;)) { s1.pop(); } else { return false; } } } if (s1.empty()) return true; else return false; }}; æ•°æ®ç»“æ„æœç„¶å¾ˆé‡è¦å•Šï¼ï¼ï¼ Time Submitted Status Runtime Memory Language a few seconds ago Accepted 4 ms 8.4 MB cpp","link":"/2019/04/11/Leetcode020-Valid Parentheses/"},{"title":"Leetcode-Remove Duplicates from Sorted Array","text":"Given a sorted array nums, remove the duplicates in-place such that each element appear only once and return the new length. Do not allocate extra space for another array, you must do this by modifying the input array in-place with O(1) extra memory. Example 1: 12345Given nums = [1,1,2],Your function should return length = 2, with the first two elements of nums being 1 and 2 respectively.It doesn&apos;t matter what you leave beyond the returned length. Example 2: 12345Given nums = [0,0,1,1,1,2,2,3,3,4],Your function should return length = 5, with the first five elements of nums being modified to 0, 1, 2, 3, and 4 respectively.It doesn&apos;t matter what values are set beyond the returned length. Clarification: Confused why the returned value is an integer but your answer is an array? Note that the input array is passed in by reference, which means modification to the input array will be known to the caller as well. Internally you can think of this: 12345678// nums is passed in by reference. (i.e., without making a copy)int len = removeDuplicates(nums);// any modification to nums in your function would be known by the caller.// using the length returned by your function, it prints the first len elements.for (int i = 0; i &lt; len; i++) { print(nums[i]);} Solution:Vectoråœ¨æ—¥å¸¸å†™ç¨‹åºç”¨çš„æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥çœ‹ä¸€çœ¼å°±æœ‰äº†ç‚¹æƒ³æ³•ã€‚ä¼ å…¥çš„æ˜¯vectorçš„å¼•ç”¨ï¼Œéœ€è¦åœ¨åŸæ•°ç»„ä¸Šæ“ä½œï¼Œvectorå·²ç»æ’åºäº†ï¼Œæ¯”è¾ƒç´¢å¼•ä¸ºiå’Œi+1çš„å…ƒç´ æ˜¯å¦ç›¸åŒå°±å¯ä»¥ï¼Œå› ä¸ºç¾è‚¡å…ƒç´ åªèƒ½å‡ºç°ä¸€æ¬¡ï¼Œæ‰€ä»¥æœ‰ä¸¤ç§è§£å†³åŠæ³•ï¼Œé‡åˆ°ç›¸åŒçš„å…ƒç´ ç§»åˆ°æœ€åæˆ–è€…åˆ é™¤ï¼Œç§»åˆ°æœ€åè¿˜è¦é¢å¤–å¢åŠ ä¸€ä¸ªå˜é‡æ¥è®¡ç®—ä¸åŒå…ƒç´ çš„æ•°é‡ï¼Œæ‰€ä»¥ç›´æ¥ç”¨åˆ é™¤çš„æ–¹å¼ã€‚éœ€è¦æ³¨æ„çš„å°±æ˜¯vectorçš„åˆ é™¤é—®é¢˜ï¼Œå½“åˆ é™¤ç´¢å¼•ä¸ºiçš„å…ƒç´ æ—¶ï¼Œiåé¢çš„å…ƒç´ éƒ½ä¼šå‘å‰ç§»åŠ¨ä¸€ä½ï¼Œè¦æ³¨æ„i++çš„ç´¢å¼•çš„å˜åŒ–ã€‚ 123456789101112131415class Solution {public: int removeDuplicates(vector&lt;int&gt;&amp; nums) { if (nums.size() == 0) { return 0; } for (int i = 0; i &lt; nums.size() - 1; i++) { if (nums[i] == nums[i + 1]) { nums.erase(nums.begin() + i + 1); i--; //æ³¨æ„ç´¢å¼•çš„å˜åŒ– } } return nums.size(); }}; Time Submitted Status Runtime Memory Language a few seconds ago Accepted 156 ms 9.9 MB cpp å¤§ç¥çš„solutionï¼š 1234567class Solution {public: int removeDuplicates(vector&lt;int&gt;&amp; nums) { nums.erase(std::unique(nums.begin(), nums.end()), nums.end()); return nums.size(); }}; Time Submitted Status Runtime Memory Language a few seconds ago Accepted 24 ms 9.8 MB cpp","link":"/2019/04/23/Leetcode026-Remove Duplicates from Sorted Array/"},{"title":"Hello World","text":"â€‹ å¾ˆæ—©ä»¥å‰å°±è§‰å¾—èƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„åšå®¢æ˜¯ç‰¹åˆ«ç‰›Xçš„äº‹æƒ…ï¼Œç»ˆäºåœ¨å¤§ç¥çš„æ…¢æ…¢å½±å“ä¸‹ï¼Œé€æ¸å»å­¦ä¹ ä»¥å‰æ²¡æƒ³è¿‡çš„ä¸œè¥¿ï¼Œæ•°å­¦ä¹Ÿå¥½ï¼Œç®—æ³•ä¹Ÿç½¢ï¼Œèµ·ç æ¯å¤©å‰è¿›ä¸€ç‚¹ã€‚ â€‹ ç»ˆäºå­¦ä¼šç”¨GitHubæ­åšå®¢äº†ï¼Œç…§ç€åšå®¢çš„æµç¨‹ç©äº†ä¸€å°å¤©ï¼Œçªç„¶å°±è§‰å¾—è‡ªå·±ä»¥å‰å¥½è ¢ï¼Œä»¥åï¼Œè¦ä¿æŒæ›´æ–°äº†ã€‚","link":"/2019/03/25/hello-world/"},{"title":"é€šè¿‡gitå°†é¡¹ç›®ä¸Šä¼ åˆ°github","text":"åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/jerryhanjj/article/details/72777618 é…ç½®Gitã€SSH ä¸‹è½½ã€å®‰è£…Git ç»‘å®šç”¨æˆ· 12$ git config --global user.name &quot;Your Name&quot; $ git config --global user.email &quot;email@example.com&quot; é…ç½®SSH åœ¨ç”¨æˆ·ä¸»ç›®å½•ä¸‹ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰.sshç›®å½•ï¼Œå¦‚æœæœ‰ï¼Œå†çœ‹çœ‹è¿™ä¸ªç›®å½•ä¸‹æœ‰æ²¡æœ‰id_rsaå’Œid_rsa.pubè¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¦‚æœå·²ç»æœ‰äº†ï¼Œå¯ç›´æ¥è·³åˆ°ä¸‹ä¸€æ­¥ã€‚å¦‚æœæ²¡æœ‰ï¼Œæ‰“å¼€Shellï¼ˆWindowsä¸‹æ‰“å¼€GitBashï¼‰ï¼Œåˆ›å»ºSSH Keyï¼Œå¯†ç å¯ä»¥ä¸è®¾ç½®ç›´æ¥å›è½¦ã€‚ 1$ ssh-keygen -t rsa -C &quot;youremail@example.com&quot; å¦‚æœä¸€åˆ‡é¡ºåˆ©çš„è¯ï¼Œå¯ä»¥åœ¨ç”¨æˆ·ä¸»ç›®å½•é‡Œæ‰¾åˆ° .sshâ€‹ç›®å½•ï¼Œé‡Œé¢æœ‰ id_rsa å’Œid_rsa.pub ä¸¤ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸¤ä¸ªå°±æ˜¯SSH Key çš„ç§˜é’¥å¯¹ï¼Œid_rsa æ˜¯ç§é’¥ï¼Œä¸èƒ½æ³„éœ²å‡ºå»ï¼Œid_rsa.pubæ˜¯å…¬é’¥ï¼Œå¯ä»¥æ”¾å¿ƒåœ°å‘Šè¯‰ä»»ä½•äººã€‚ç”¨è®°äº‹æœ¬æ‰“å¼€ id_rsa.pubï¼Œå¾—åˆ°ssh key å…¬é’¥ã€‚ ä¸º Github è´¦æˆ·æ·»åŠ  ssh key ã€‚ç™»å½• Githubï¼Œå±•å¼€ä¸ªäººå¤´åƒçš„å°ä¸‰è§’ï¼Œç‚¹settingsï¼Œç„¶åæ‰“å¼€SSH keysèœå•ï¼Œç‚¹å‡»Add SSH keyæ–°å¢å¯†é’¥ï¼Œå¡«ä¸Šæ ‡é¢˜ã€‚ ä¸Šä¼ é¡¹ç›® å»ºç«‹ä»“åº“ å¡«ä¸€ä¸‹ä»“åº“åç§°ï¼ŒInitialize this repository with a READMEæ˜¯å¯é€‰çš„ï¼Œå»ºè®®åœ¨åˆ›å»ºæ—¶é€‰ä¸Šï¼Œå¯ä»¥åœ¨åé¢çœä¸€ä¸ªæ­¥éª¤ã€‚å¡«å¥½ä¹‹åï¼Œç‚¹Create repositoryå®Œæˆä»“åº“çš„å»ºç«‹ã€‚ å…‹éš†ä»“åº“ å¦‚æœæ˜¯å…¨æ–°çš„é¡¹ç›®æ²¡æœ‰ä»»ä½•æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å…‹éš†ä»“åº“ï¼Œè·³è¿‡è¿™ä¸€æ­¥ã€‚ç‚¹å¼€ Git Shellï¼Œè¿›å…¥å‘½ä»¤è¡Œã€‚é¦–å…ˆæˆ‘ä»¬å…ˆè¦æŠŠ GitHub ä¸Šçš„æˆ‘ä»¬æ–°å»ºçš„ä»“åº“ cloneä¸‹æ¥ã€‚åœ¨åˆå§‹åŒ–ç‰ˆæœ¬åº“ä¹‹å‰ï¼Œå…ˆè¦ç¡®è®¤è®¤è¯çš„å…¬é’¥æ˜¯å¦æ­£ç¡®ã€‚ 1$ ssh -T git@github.com å¦‚æœæ”¶åˆ°æˆåŠŸçš„ç¡®è®¤æ¶ˆæ¯ï¼Œå°±å¯ä»¥å¼€å§‹å…‹éš†è¿œç¨‹ä»“åº“äº†ã€‚ 1$ git clone https://github.com/username/program-name.git å…‹éš†ä»“åº“ä¹‹åå°±åœ¨æ–‡ä»¶å¤¹ä¸­å‡ºç°äº†é¡¹ç›®æ–‡ä»¶å¤¹åŠæ–‡ä»¶,è¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œå¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ã€‚ 1$ git init ä¸Šä¼ READMEæ–‡ä»¶ å¦‚æœåœ¨åˆ›å»º Github ä»“åº“æ—¶æ²¡æœ‰å‹¾é€‰åˆ›å»º README.md æ–‡ä»¶ï¼Œåˆ™è¦å…ˆåˆ›å»º README.md æ–‡ä»¶ï¼Œä¸ç„¶ä¸Šä¼ æ–‡ä»¶ä¼šæŠ¥é”™ã€‚å¦‚æœå·²ç»å‹¾é€‰ï¼Œå¯ä»¥è·³è¿‡æ­¤æ­¥éª¤ã€‚ 12345$ git init$ touch README.md$ git add README.md$ git commit -m &apos;first_commit&apos;$ git remote add origin ä¸Šä¼ é¡¹ç›® è·Ÿè¸ªé¡¹ç›®æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼š 1$ git add . è¾“å…¥æœ¬æ¬¡çš„æäº¤è¯´æ˜ï¼Œå‡†å¤‡æäº¤æš‚å­˜åŒºä¸­çš„æ›´æ”¹çš„å·²è·Ÿè¸ªæ–‡ä»¶ï¼Œå•å¼•å·å†…ä¸ºè¯´æ˜å†…å®¹ï¼š 1$ git commit -m &apos;first_commit&apos; å…³è”è¿œç¨‹ä»“åº“ï¼Œæ·»åŠ åï¼Œè¿œç¨‹åº“çš„åå­—å°±æ˜¯ originï¼Œè¿™æ˜¯ Git é»˜è®¤çš„å«æ³•ï¼Œä¹Ÿå¯ä»¥æ”¹æˆåˆ«çš„ï¼Œä½†æ˜¯ origin è¿™ä¸ªåå­—ä¸€çœ‹å°±çŸ¥é“æ˜¯è¿œç¨‹åº“ã€‚ 1$ git remote add origin https://github.com/username/program-name.git å¦‚æœå…³è”å‡ºç°é”™è¯¯ fatal: remote origin already existsï¼Œåˆ™æ‰§è¡Œgit remote rm originå†è¿›è¡Œå…³è”ã€‚ æŠŠæœ¬åœ°åº“çš„æ‰€æœ‰å†…å®¹æ¨é€åˆ°è¿œç¨‹åº“ä¸Šï¼š 1$ git push -u origin master å¦‚æœåœ¨æ¨é€æ—¶å‡ºç°é”™è¯¯ error:failed to push som refs to.......ï¼Œåˆ™æ‰§è¡Œä¸‹åˆ—è¯­å¥ï¼š 1$ git pull origin master å°†è¿œç¨‹ä»“åº“ Github ä¸Šçš„æ–‡ä»¶æ‹‰ä¸‹æ¥åˆå¹¶ä¹‹åé‡æ–°æ¨é€ä¸Šå»ã€‚","link":"/2019/03/27/é€šè¿‡gitå°†é¡¹ç›®ä¸Šä¼ åˆ°github/"},{"title":"C++è°ƒç”¨Pythonç‰ˆMask-R-CNNå¹¶ä¼ é€’å’Œæ¥æ”¶å‚æ•°","text":"æƒ³åšä¸€ä¸ªç”¨Mask R-CNNåªæ£€æµ‹äººçš„demoï¼Œå‘ç°githubå·²ç»æœ‰äººç”¨Pythonå®ç°äº†ï¼Œä½†åå¤„ç†ç”¨çš„æ˜¯C++ï¼Œæ‰€ä»¥æƒ³ç›´æ¥ç”¨C++å™¨è°ƒç”¨pythonï¼Œå†å°†éœ€è¦çš„ç»“æœè¿”å›ç»™C++ã€‚ è¿è¡Œç¯å¢ƒï¼š Visual Studio 2015ï¼ŒPython3.6ï¼ˆAnacondaï¼‰ï¼ŒOpenCV3.4.2ï¼ˆC++ï¼‰ï¼Œtensorflow1.12ï¼ŒKeras2.0.8 C++ç¯å¢ƒé…ç½® é…ç½®OpenCV æ–°å»ºä¸€ä¸ªC++å·¥ç¨‹ï¼› å³é”®å±æ€§$\\rightarrow$C++ç›®å½•$\\rightarrow$åŒ…å«ç›®å½•$\\rightarrow$ç‚¹å‡»ç¼–è¾‘ï¼Œå°† 123D:\\Programs\\opencv\\build\\includeD:\\Programs\\opencv\\build\\include\\opencvD:\\Programs\\opencv\\build\\include\\opencv2 åŠ å…¥åŒ…å«ç›®å½•ï¼Œæ³¨æ„é…ç½®çš„æ–¹æ¡ˆå¹³å°ç‰ˆæœ¬å’Œå½“å‰è¿è¡Œçš„ä¸€è‡´ï¼› å³é”®å±æ€§$\\rightarrow$C++ç›®å½•$\\rightarrow$åº“ç›®å½•$\\rightarrowâ€‹$ç‚¹å‡»ç¼–è¾‘ï¼Œå°† 1D:\\Programs\\opencv\\build\\x64\\vc14\\lib åŠ å…¥åº“ç›®å½•ï¼Œæ³¨æ„VSçš„ç‰ˆæœ¬ï¼Œ2017æ”¹ç”¨vc15çš„ç›®å½•ï¼› å³é”®å±æ€§$\\rightarrow$é“¾æ¥å™¨$\\rightarrow$è¾“å…¥$\\rightarrow$ç‚¹å‡»ç¼–è¾‘ï¼Œå°† 1opencv_world342.lib åŠ å…¥å…¶ä¸­ã€‚ é…ç½®Pythonç¯å¢ƒ å³é”®å±æ€§$\\rightarrow$C++ç›®å½•$\\rightarrow$åŒ…å«ç›®å½•$\\rightarrowâ€‹$ç‚¹å‡»ç¼–è¾‘ï¼Œå°† 12D:\\Programs\\Anaconda3\\includeD:\\Programs\\Anaconda3\\Lib\\site-packages\\numpy\\core\\include åŠ å…¥åˆ°åŒ…å«ç›®å½•ä¸­ï¼› å³é”®å±æ€§$\\rightarrow$C++ç›®å½•$\\rightarrow$åº“ç›®å½•$\\rightarrow$ç‚¹å‡»ç¼–è¾‘ï¼Œå°† 12D:\\Programs\\Anaconda3\\libsD:\\Programs\\Anaconda3\\Lib\\site-packages\\numpy\\core\\lib åŠ å…¥åº“ç›®å½•; å³é”®å±æ€§$\\rightarrow$é“¾æ¥å™¨$\\rightarrow$è¾“å…¥$\\rightarrow$ç‚¹å‡»ç¼–è¾‘ï¼Œå°† 1python36.lib åŠ å…¥å…¶ä¸­ï¼Œæ³¨æ„åªæœ‰python36ï¼Œæ²¡æœ‰python36dï¼Œæ‰€ä»¥è°ƒè¯•çš„æ—¶å€™è¦ç”¨releseçš„ç‰ˆæœ¬ï¼Œdebugçš„ç‰ˆæœ¬ä¼šæŠ¥é”™ã€‚ è°ƒç”¨Python ä»C++è¾“å…¥å›¾ç‰‡æ•°æ® ç”±äºC++ç”¨OpenCVè¯»å–çš„å›¾ç‰‡æ ¼å¼å’ŒMask R-CNNçš„è¾“å…¥æ ¼å¼ä¸åŒï¼Œæ‰€ä»¥éœ€è¦å…ˆç”¨C++å¤„ç†å¥½å›¾ç‰‡ï¼Œä¼ é€’ç»™Pythonã€‚ 12345678910111213141516171819202122232425262728Mat img = imread(&quot;./image.jpg&quot;);auto sz = img.size();int x = sz.width;int y = sz.height;int z = img.channels();uchar *CArrays = new uchar[x*y*z];int iChannels = img.channels();int iRows = img.rows;int iCols = img.cols * iChannels;if (img.isContinuous()){ iCols *= iRows; iRows = 1;}uchar* p;int id = -1;for (int i = 0; i &lt; iRows; i++){ // get the pointer to the ith row p = img.ptr&lt;uchar&gt;(i); // operates on each pixel for (int j = 0; j &lt; iCols; j++) { CArrays[++id] = p[j];//è¿ç»­ç©ºé—´ }}npy_intp Dims[3] = {y, x, z}; //æ³¨æ„è¿™ä¸ªç»´åº¦æ•°æ®ï¼PyObject *PyArray = PyArray_SimpleNewFromData(3, Dims, NPY_UBYTE, CArrays); è°ƒç”¨Mask R-CNN 1234567891011121314151617181920212223242526272829303132333435363738394041//åˆå§‹åŒ–pythonPy_Initialize();import_array();PyRun_SimpleString(&quot;import sys&quot;); PyRun_SimpleString(&quot;sys.path.append(r&apos;C:\\\\Users\\\\Administrator\\\\Documents\\\\Keypoints-of-humanpose-with-Mask-R-CNN-master&apos;)&quot;);//å®šä¹‰pythonç±»å‹çš„å˜é‡PyObject *pModule = NULL;PyObject *pFunc = NULL;PyObject *pArg = NULL;PyObject *result = NULL;PyObject *pDict = NULL;//ç›´æ¥è¿è¡Œpythonä»£ç PyRun_SimpleString(&quot;print(&apos;python start&apos;)&quot;);PyObject *ArgList = PyTuple_New(1);...PyTuple_SetItem(ArgList, 0, PyArray);//å¼•å…¥æ¨¡å—pModule = PyImport_ImportModule(&quot;human_detected&quot;);if (!pModule){ cout &lt;&lt; &quot;Import Module Failed&quot; &lt;&lt; endl; system(&quot;pause&quot;); return 0;}//è·å–æ¨¡å—å­—å…¸å±æ€§pDict = PyModule_GetDict(pModule);//ç›´æ¥è·å–æ¨¡å—ä¸­çš„å‡½æ•°pFunc = PyObject_GetAttrString(pModule, &quot;detect&quot;);... Mask R-CNNæ¥å—å‚æ•°å¹¶è¿”å›å€¼ Mask R-CNNæ£€æµ‹äººé¡¹ç›®åœ°å€ï¼šhttps://github.com/Junyuan12/Mask_RCNN_Humanpose Mask R-CNNçš„é…ç½®å°±ä¸ç»†è¯´äº†ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œä¸»è¦æ˜¯windowsä¸‹é…ç½®pycocotoolså¯èƒ½ä¼šæœ‰é—®é¢˜ï¼Œ windowsä¸‹pycocotoolså®‰è£…æ•™ç¨‹ï¼šhttps://blog.csdn.net/qq_29592829/article/details/82877494 åœ¨Mask R-CNNä¸­æ–°å»ºä¸€ä¸ªpyæ–‡ä»¶ï¼Œhuman_detected.py 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172import osimport sysimport randomimport mathimport numpy as npimport skimage.ioimport matplotlibimport matplotlib.pyplot as pltimport cocoimport utilsimport model as modellibimport visualizefrom model import logimport cv2def detect(image): # print(image) ROOT_DIR = os.getcwd() # Directory to save logs and trained model MODEL_DIR = os.path.join(ROOT_DIR, &quot;mylogs&quot;) # Local path to trained weights file COCO_MODEL_PATH = os.path.join(ROOT_DIR, &quot;mask_rcnn_coco_humanpose.h5&quot;) # Download COCO trained weights from Releases if needed if not os.path.exists(COCO_MODEL_PATH): utils.download_trained_weights(COCO_MODEL_PATH) class InferenceConfig(coco.CocoConfig): GPU_COUNT = 1 IMAGES_PER_GPU = 1 KEYPOINT_MASK_POOL_SIZE = 7 inference_config = InferenceConfig() # Recreate the model in inference mode model = modellib.MaskRCNN(mode=&quot;inference&quot;, config=inference_config, model_dir=MODEL_DIR) # Get path to saved weights model_path = os.path.join(ROOT_DIR, &quot;mask_rcnn_coco_humanpose.h5&quot;) assert model_path != &quot;&quot;, &quot;Provide path to trained weights&quot; print(&quot;Loading weights from &quot;, model_path) model.load_weights(model_path, by_name=True) # COCO Class names #For human pose task We just use &quot;BG&quot; and &quot;person&quot; class_names = [&apos;BG&apos;, &apos;person&apos;] #BGR-&gt;RGB image = image[:,:,::-1] #print(np.shape(image)) # Run detection results = model.detect_keypoint([image], verbose=1) r = results[0] # for one image log(&quot;rois&quot;,r[&apos;rois&apos;]) log(&quot;keypoints&quot;,r[&apos;keypoints&apos;]) log(&quot;class_ids&quot;,r[&apos;class_ids&apos;]) log(&quot;keypoints&quot;,r[&apos;keypoints&apos;]) log(&quot;masks&quot;,r[&apos;masks&apos;]) log(&quot;scores&quot;,r[&apos;scores&apos;]) visualize.display_instances(image, r[&apos;rois&apos;], r[&apos;masks&apos;], r[&apos;class_ids&apos;], class_names, r[&apos;scores&apos;]) flat_roi = r[&apos;rois&apos;].flatten() print(flat_roi) return flat_roi å…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªå‡½æ•°detect(image)ï¼Œç”¨äºæ¥å—C++ä¼ è¿›æ¥çš„å›¾ç‰‡ï¼Œå¹¶æœ€ç»ˆè¿”å›æ¯ä¸ªäººçš„roiã€‚ C++æ¥å—è¿”å›å‚æ•° pythonå°†ç»“æœå±•å¼€æˆä¸€åˆ—ï¼ŒC++æ¥å—è¿”å›çš„ä¸€ç»´æ•°ç»„å¹¶è¾“å‡ºï¼š 1234567891011121314151617181920212223// è°ƒç”¨ç›´æ¥è·å¾—çš„å‡½æ•°,å¹¶ä¼ é€’å‚æ•°PyObject *pReturn = PyObject_CallObject(pFunc, ArgList);//è·å–pythonç¨‹åºçš„è¿”å›ç»“æœ//ä»¥ä¸‹æ˜¯å¯¹è¿”å›çš„ä¸€ç»´æ•°ç»„ç»“æœè¿›è¡Œå¤„ç†if (pReturn){ //å°†ç»“æœç±»å‹è½¬æ¢æˆæ•°ç»„å¯¹è±¡ç±»å‹ PyArrayObject *pyResultArr = (PyArrayObject *)pReturn; //ä»Pythonä¸­çš„PyArrayObjectè§£æå‡ºæ•°ç»„æ•°æ®ä¸ºcçš„doubleç±»å‹ã€‚ int *resDataArr = (int *)PyArray_DATA(pyResultArr); int dimNum = PyArray_NDIM(pyResultArr);//è¿”å›æ•°ç»„çš„ç»´åº¦æ•°ï¼Œæ­¤å¤„æ’ä¸º1 npy_intp *pdim = PyArray_DIMS(pyResultArr);//è¿”å›æ•°ç»„å„ç»´åº¦ä¸Šçš„å…ƒç´ ä¸ªæ•°å€¼ //ä»¥ä¸‹æ˜¯å¯¹è¿”å›ç»“æœçš„è¾“å‡ºæ˜¾ç¤º for (int i = 0; i &lt; dimNum; ++i) { for (int j = 0; j &lt; pdim[0]; ++j) cout &lt;&lt; resDataArr[i * pdim[0] + j] &lt;&lt; &quot;,&quot;; } cout &lt;&lt; endl;} å®Œæ•´ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112#include &lt;Python.h&gt;#include &lt;iostream&gt;#include &lt;string&gt;#include &lt;numpy/arrayobject.h&gt;#include &lt;opencv2/highgui/highgui.hpp&gt;#include &lt;opencv2/imgproc/imgproc.hpp&gt;#include &lt;opencv2/core/core.hpp&gt;using namespace std;int main(int argc, char* argv[]){ cv::Mat img = cv::imread(&quot;./image.jpg&quot;); //åˆå§‹åŒ–python Py_Initialize(); import_array(); PyRun_SimpleString(&quot;import sys&quot;); PyRun_SimpleString(&quot;sys.path.append(r&apos;C:\\\\Users\\\\Administrator\\\\Documents\\\\Keypoints-of-humanpose-with-Mask-R-CNN-master&apos;)&quot;); //PyRun_SimpleString(&quot;print(sys.path)&quot;); //å®šä¹‰pythonç±»å‹çš„å˜é‡ PyObject *pModule = NULL; PyObject *pFunc = NULL; PyObject *pArg = NULL; PyObject *result = NULL; PyObject *pDict = NULL; //ç›´æ¥è¿è¡Œpythonä»£ç  PyRun_SimpleString(&quot;print(&apos;python start&apos;)&quot;); PyObject *ArgList = PyTuple_New(1); auto sz = img.size(); int x = sz.width; int y = sz.height; int z = img.channels(); uchar *CArrays = new uchar[x*y*z]; int iChannels = img.channels(); int iRows = img.rows; int iCols = img.cols * iChannels; if (img.isContinuous()) { iCols *= iRows; iRows = 1; } uchar* p; int id = -1; for (int i = 0; i &lt; iRows; i++) { // get the pointer to the ith row p = img.ptr&lt;uchar&gt;(i); // operates on each pixel for (int j = 0; j &lt; iCols; j++) { CArrays[++id] = p[j];//è¿ç»­ç©ºé—´ } } npy_intp Dims[3] = { y, x, z }; //æ³¨æ„è¿™ä¸ªç»´åº¦æ•°æ®ï¼ PyObject *PyArray = PyArray_SimpleNewFromData(3, Dims, NPY_UBYTE, CArrays); PyTuple_SetItem(ArgList, 0, PyArray); //å¼•å…¥æ¨¡å— pModule = PyImport_ImportModule(&quot;human_detected&quot;); if (!pModule) { cout &lt;&lt; &quot;Import Module Failed&quot; &lt;&lt; endl; system(&quot;pause&quot;); return 0; } //è·å–æ¨¡å—å­—å…¸å±æ€§ pDict = PyModule_GetDict(pModule); //ç›´æ¥è·å–æ¨¡å—ä¸­çš„å‡½æ•° pFunc = PyObject_GetAttrString(pModule, &quot;detect&quot;); // è°ƒç”¨ç›´æ¥è·å¾—çš„å‡½æ•°,å¹¶ä¼ é€’å‚æ•° PyObject *pReturn = PyObject_CallObject(pFunc, ArgList); //è·å–pythonç¨‹åºçš„è¿”å›ç»“æœ //ä»¥ä¸‹æ˜¯å¯¹è¿”å›çš„ä¸€ç»´æ•°ç»„ç»“æœè¿›è¡Œå¤„ç† if (pReturn) { //å°†ç»“æœç±»å‹è½¬æ¢æˆæ•°ç»„å¯¹è±¡ç±»å‹ PyArrayObject *pyResultArr = (PyArrayObject *)pReturn; //ä»Pythonä¸­çš„PyArrayObjectè§£æå‡ºæ•°ç»„æ•°æ®ä¸ºcçš„doubleç±»å‹ã€‚ int *resDataArr = (int *)PyArray_DATA(pyResultArr); int dimNum = PyArray_NDIM(pyResultArr);//è¿”å›æ•°ç»„çš„ç»´åº¦æ•°ï¼Œæ­¤å¤„æ’ä¸º1 npy_intp *pdim = PyArray_DIMS(pyResultArr);//è¿”å›æ•°ç»„å„ç»´åº¦ä¸Šçš„å…ƒç´ ä¸ªæ•°å€¼ //ä»¥ä¸‹æ˜¯å¯¹è¿”å›ç»“æœçš„è¾“å‡ºæ˜¾ç¤º for (int i = 0; i &lt; dimNum; ++i) { for (int j = 0; j &lt; pdim[0]; ++j) cout &lt;&lt; resDataArr[i * pdim[0] + j] &lt;&lt; &quot;,&quot;; } cout &lt;&lt; endl; } PyRun_SimpleString(&quot;print(&apos;python end&apos;)&quot;); ////é‡Šæ”¾python Py_Finalize(); system(&quot;pause&quot;); return 0;}","link":"/2019/03/31/C++è°ƒç”¨Pythonç‰ˆMask-R-CNNå¹¶ä¼ é€’å’Œæ¥æ”¶å‚æ•°/"},{"title":"è®ºæ–‡é˜…è¯»â€”â€”Faster RCNNï¼ŒRegion Proposal Networkå¥½åœ¨å“ªé‡Œ","text":"Faster RCNNæ˜¯ä¸ºç›®æ ‡æ£€æµ‹è€Œæå‡ºçš„ä¸€ç§ç½‘ç»œï¼Œç›®æ ‡æ£€æµ‹çš„ä»»åŠ¡æ˜¯ä»ä¸€å¼ ç»™å®šçš„å›¾ç‰‡ä¸­ä¸ä»…è¦å¯¹å›¾åƒä¸­çš„ç‰©ä½“è¿›è¡Œåˆ†ç±»ï¼Œè€Œä¸”è¦ä¸ºæ¯ä¸ªç±»åˆ«çš„ç‰©ä½“åŠ ä¸€ä¸ªBoxï¼Œä¹Ÿå°±æ˜¯è¦ç¡®å®šæ£€æµ‹åˆ°çš„ç‰©ä½“çš„ä½ç½®ã€‚ é˜…è¯»å‰å‡†å¤‡Faster RCNNç”±Fast RCNNæ”¹è¿›ï¼Œæ‰€ä»¥ç®€å•äº†è§£RCNNå’ŒFast RCNNã€‚ RCNNRCNNä½¿ç”¨selective searchæ–¹æ³•ï¼Œä¸ºæ¯å¼ å›¾ç‰‡æå‡ºå¤§æ¦‚1k~2kä¸ªå€™é€‰åŒºåŸŸï¼Œç„¶åå°†æ¯ä¸ªå€™é€‰åŒºåŸŸéƒ½è¾“å…¥åˆ°ç½‘ç»œä¸­ï¼Œè¿›è¡Œç‰¹å¾æå–ï¼Œä¹‹åè¾“å…¥åˆ°ä¸€ä¸ªSVMåˆ†ç±»å™¨ä¸­åˆ¤æ–­ç‰©ä½“ç±»åˆ«ï¼Œæœ€åä½¿ç”¨ä¸€ä¸ªå›å½’å™¨å¾—åˆ°ç‰©ä½“çš„ç²¾ç¡®ä½ç½®ï¼Œå³Boxã€‚é€šè¿‡ç®€å•æè¿°å°±å¯ä»¥çœ‹å‡ºï¼ŒRCNNçš„ç¼ºç‚¹éå¸¸æ˜æ˜¾ï¼Œå¯¹äºç°åœ¨çš„ç½‘ç»œï¼ŒåŸºæœ¬éƒ½æ˜¯ç«¯åˆ°ç«¯çš„ç»“æ„ï¼Œè€ŒRCNNçš„å¤„ç†æµç¨‹å¾ˆå¤æ‚ï¼Œå¹¶ä¸”ä¿å­˜æ¯ä¸ªå€™é€‰åŒºåŸŸçš„ç‰¹å¾ä¹Ÿä¼šå ç”¨éå¸¸å¤šçš„ç©ºé—´ï¼›å…¶äºŒï¼Œå¯¹è¿™ä¹ˆå¤šçš„å€™é€‰åŒºåŸŸï¼Œè®¡ç®—ä¼šæµªè´¹éå¸¸å¤šçš„æ—¶é—´ï¼Œè€Œä¸”æå–çš„ç‰¹å¾ä¼šé‡å¤ã€‚ Fast RCNNFast RCNNä½œä¸ºRCNNçš„è¿›é˜¶ç‰ˆï¼Œä¸»è¦æ”¹è¿›åœ¨ä¸¤æ–¹é¢ï¼Œä¸€ä¸ªæ˜¯åªéœ€è¦å¯¹è¾“å…¥å›¾åƒæä¸€æ¬¡ç‰¹å¾ï¼Œç„¶åå°†æ‰¾åˆ°å€™é€‰åŒºåŸŸå¯¹åº”çš„ç‰¹å¾ï¼Œå¯¹ç‰¹å¾è¿›è¡Œåˆ†ç±»å’Œå›å½’å¾—åˆ°Boxï¼›å¦ä¸€æ–¹é¢æ˜¯ROI Poolingï¼Œç”±äºç½‘ç»œä¸­å…¨è¿æ¥å±‚çš„å­˜åœ¨ï¼Œæ‰€ä»¥è¦æ±‚ç½‘ç»œæ‰€è°“è¾“å…¥å¤§å°å¿…é¡»æ˜¯ç›¸åŒçš„ï¼Œä½†selective searché€‰å‡ºçš„å€™é€‰åŒºåŸŸå¤§å°ä¸åŒï¼Œå¦‚æœç›´æ¥å°†è¾“å…¥å›¾åƒéƒ½ç¼©æ”¾åˆ°ç›¸åŒçš„å¤§å°ï¼Œä¼šä¸¢å¤±å›¾åƒçš„ä¿¡æ¯ï¼›é€šè¿‡ROI Poolingå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç›¸æ¯”è¾ƒäºMax Poolingå›ºå®šçš„strideï¼ŒROI Poolingçš„strideæ˜¯æ ¹æ®è¾“å‡ºçš„å¤§å°æ¥å†³å®šçš„ï¼Œæ¯”å¦‚å½“å‰ROI feature mapçš„å¤§å°ä¸º$h \\times w$ï¼Œç»è¿‡ROI Poolingåè¾“å‡ºçš„å›ºå®šå¤§å°ä¸º$H \\times W$ï¼Œé‚£ä¹ˆROI Poolingçš„strideå°±æ˜¯$\\frac{h}{H} \\times \\frac{w}{W}$ã€‚ Faster RCNNè®ºæ–‡æ ¸å¿ƒ we introduce a Region Proposal Network (RPN) that shares full-image convolutional features with the detection network, thus enabling nearly cost-free region proposals. è®ºæ–‡ä¸­æå‡ºä¸€ç§æ–°çš„é€‰æ‹©Region proposalsçš„æ–¹æ³•ï¼Œç”¨RPNä»£æ›¿Fast RCNNä¸­Selective searchï¼ŒRPNä¸object detection networkå…±äº«å·ç§¯å±‚ï¼ŒèŠ‚çœäº†å¤§é‡é€‰æ‹©å€™é€‰åŒºåŸŸçš„æ—¶é—´ï¼ŒSS $2s$ per image, RPN $10ms$ per imageã€‚ Anchor RPNs are designed to efficiently predict region proposals with a wide range of scales and aspect ratios. æå‡ºäº†anchoråšå¤šå°ºåº¦å’Œé•¿å®½æ¯”çš„å‚è€ƒï¼Œé¿å…äº†æšä¸¾å¤šä¸ªå°ºåº¦çš„ä¿¡æ¯ã€‚ anchorçš„å®ç°è¿‡ç¨‹ï¼š å¯¹ä¸€å¹…å›¾åƒï¼Œç»è¿‡ç½‘ç»œä¸‹é‡‡æ ·å¾—åˆ°feature mapï¼Œå¯¹feature mapä¸­çš„ä¸€ä¸ªç‚¹ï¼Œæ‰¾åˆ°å…¶åœ¨åŸå§‹å›¾å½¢å¯¹åº”çš„åŒºåŸŸï¼Œæ¯”å¦‚ï¼Œä¸€å¹…å›¾åƒç»è¿‡3æ¬¡Poolingï¼Œé‚£ä¹ˆå¾—åˆ°çš„ç‰¹å¾ä¸­çš„ä¸€ä¸ªç‚¹å¯¹åº”åŸå§‹å›¾åƒå°±æ˜¯ä¸€ä¸ª$16 \\times 16$ çš„åŒºåŸŸï¼Œå¯¹è¿™ä¸ªåŒºåŸŸç”Ÿæˆä¸åŒanchorã€‚ é¦–å…ˆå¯¹è¯¥åŒºåŸŸç”Ÿæˆ3ç§é•¿å®½æ¯”çš„anchorï¼ˆ$ratios=[0.5,1,2]$ï¼‰ï¼š 123456789def _whctrs(anchor): \"\"\" Return width, height, x center, and y center of an anchor. \"\"\" w = anchor[2] - anchor[0] + 1 h = anchor[3] - anchor[1] + 1 x_ctr = anchor[0] + 0.5 * (w - 1) y_ctr = anchor[1] + 0.5 * (h - 1) return w, h, x_ctr, y_ctr 12345678910111213141516171819def _mkanchors(ws, hs, x_ctr, y_ctr): \"\"\" Getting coordinates of different window width ratios around the same center. Parameters: ws : A sist of X coordinates in the upper left corner of a anchor. hs : A sist of Y coordinates in the upper left corner of a anchor. x_ctr : X-coordinates of the center of a anchor. y_ctr : Y-coordinates of the center of a anchor. Return: anchors : Coordinates with different aspect ratios. \"\"\" ws = ws[:, np.newaxis] hs = hs[:, np.newaxis] anchors = np.hstack((x_ctr - 0.5 * (ws - 1), y_ctr - 0.5 * (hs - 1), x_ctr + 0.5 * (ws - 1), y_ctr + 0.5 * (hs - 1))) return anchors 12345678910111213141516171819def _ratio_enum(anchor, ratios): ''' Enumerate a set of anchors for each aspect ratio wrt an anchor. Parameters: anchor : A list contains coordinates of the upper left and lower right corners. ratios : A list contains different aspect ratios. Return: anchors : Coordinates with different aspect ratios. ''' w, h, x_ctr, y_ctr = _whctrs(anchor) size = w * h #size:16*16=256 size_ratios = size / np.array(ratios) #256/ratios[0.5,1,2]=[512,256,128] ws = np.round(np.sqrt(size_ratios)) #ws:[23 16 11] hs = np.round(ws * ratios) #hs:[12 16 22] anchors = _mkanchors(ws, hs, x_ctr, y_ctr) return anchors è¿è¡Œç»“æœï¼Œå¾—åˆ°åŒä¸€ä¸­å¿ƒ3ä¸ªé•¿å®½æ¯”çš„anchorï¼š 12345_ratio_enum([0, 0, 15, 15], [0.5, 1, 2])array([[-3.5, 2. , 18.5, 13. ], [ 0. , 0. , 15. , 15. ], [ 2.5, -3. , 12.5, 18. ]]) ç„¶åå¯¹æ¯ä¸ªé•¿å®½æ¯”çš„anchorè¿›è¡Œ3ç§é¢ç§¯å˜æ¢ï¼ˆ$scales=[8, 16, 32]$ï¼‰ï¼š 123456789101112131415def _scale_enum(anchor, scales): \"\"\" Enumerate a set of anchors for each scale wrt an anchor. Parameters: anchor : Orginal anchor. scales : Scaling factor. Return: Scaled coordinates of anchor. \"\"\" w, h, x_ctr, y_ctr = _whctrs(anchor) ws = w * scales hs = h * scales anchors = _mkanchors(ws, hs, x_ctr, y_ctr) return anchors è¿è¡Œç»“æœï¼Œå¾—åˆ°1ä¸ªç‰¹å¾ç‚¹å¯¹åº”çš„ä¸åŒé•¿å®½æ¯”å’Œä¸åŒç¼©æ”¾ç³»æ•°å¯¹åº”çš„9ä¸ªanchorï¼š 123456789101112131415scales = 2**np.arange(3, 6) #[8, 16, 32]#åˆ«é—®æˆ‘é‡Œä¸ºä»€ä¹ˆæ˜¯15ä¸æ˜¯16ï¼Œæˆ‘ä¹Ÿåœ¨ç ”ç©¶ratio_anchors = _ratio_enum([0,0,15,15], [0.5, 1, 2])np.vstack([_scale_enum(ratio_anchors[i, :], scales) for i in range(ratio_anchors.shape[0])])array([[ -84., -40., 99., 55.], [-176., -88., 191., 103.], [-360., -184., 375., 199.], [ -56., -56., 71., 71.], [-120., -120., 135., 135.], [-248., -248., 263., 263.], [ -36., -80., 51., 95.], [ -80., -168., 95., 183.], [-168., -344., 183., 359.]]) ä¸‹é¢è¿™ä¸ªè¡¨æ ¼å¯¹æ¯”äº†9ç§å°ºå¯¸çš„anchorçš„å˜æ¢ï¼š .tg {border-collapse:collapse;border-spacing:0;}.tg td{font-family:Arial, sans-serif;font-size:14px;padding:3px 20px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:3px 20px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}.tg .tg-uys7{border-color:inherit;text-align:center}.tg .tg-xldj{border-color:inherit;text-align:left} base_anchor ratios å®½ï¼Œé«˜ï¼Œä¸­å¿ƒç‚¹æ¨ªåæ ‡ï¼Œä¸­å¿ƒç‚¹çºµåæ ‡ åæ ‡ 16x16 23x122:1 [184,96,7.5,7.5] scale=8 [ -84. -40. 99. 55.] [368,192,7.5,7.5] scale=16 [-176. -88. 191. 103.] [736,384,7.5,7.5] scale=32 [-360. -184. 375. 199.] 16x161:1 [128,128,7.5,7.5] scale=8 [ -56. -56. 71. 71.] [256,256,7.5,7.5] scale=16 [-120. -120. 135. 135.] [512,512,7.5,7.5] scale=32 [-248. -248. 263. 263.] 11x221:2 [88,176,7.5,7.5] scale=8 [ -36. -80. 51. 95.] [176,352,7.5,7.5] scale=16 [ -80. -168. 95. 183.] [352,704,7.5,7.5] scale=32 [-168. -344. 183. 359.] å¾—åˆ°çš„anchorå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè“è‰²ç‚¹ä»£è¡¨feature mapä¸­çš„ç‰¹å¾ç‚¹ï¼Œæ¯ç§é¢œè‰²æ¡†ä»£è¡¨ä¸€ç§é•¿å®½æ¯”ï¼ŒåŒä¸€é¢œè‰²ä¸åŒå¤§å°çš„çŸ©å½¢æ¡†ä»£è¡¨ä¸åŒçš„å°ºåº¦ï¼šæ‰‹è´±å°±æƒ³ç”»å›¾ï¼Œç»“æœå°±è¢«è‡ªå·±è ¢åˆ°äº†ã€‚ pltç”»çŸ©å½¢çš„é»˜è®¤åæ ‡ç³»å¤§å°éƒ½æ˜¯1ï¼Œæ‰€ä»¥æƒ³ç”»å¤§ä¸€ç‚¹çš„çŸ©å½¢ï¼Œä¸€å®šè¦å…ˆè®¾ç½®åæ ‡ç³»çš„å¤§å° æˆ‘ä¸€åº¦ä»¥ä¸ºæˆ‘å‘ç°äº†matplotlibçš„BUGğŸ˜«ğŸ˜«ğŸ˜« é™„ä»£ç ï¼š 12345678910111213import matplotlib.pyplot as pltcolors = [\"red\", \"blue\", \"green\"]fig = plt.figure(figsize=(10, 10))ax = fig.add_subplot(1,1,1)plt.xlim((-500, 500)) #è®¾ç½®xè½´çš„å¤§å°plt.ylim((-500, 500)) #è®¾ç½®yè½´çš„å¤§å°plt.scatter(7.5, 7.5)for i in range(9): rect = plt.Rectangle((anchors[i][0], anchors[i][1] + anchors[i][3] - anchors[i][1]), anchors[i][2] - anchors[i][0], anchors[i][1] - anchors[i][3], fill=False, edgecolor = colors[i//3],linewidth=2) ax.add_patch(rect)plt.show() Region proposal Network Faster R-CNN is composed of two modules. The first module is a deep fully convolutional network that proposes regions, and the second module is the Fast R-CNN detector that uses the proposed regions. Faster R-CNNç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯æ˜¯Region proposal networkï¼Œçªå‡ºç”¨äºæ£€æµ‹çš„å€™é€‰åŒºåŸŸï¼Œå¦ä¸€éƒ¨åˆ†å’ŒFast RCNNä¸€æ ·ï¼Œå¯¹å€™é€‰åŒºåŸŸè¿›è¡Œæ£€æµ‹ï¼Œè¾“å‡ºç›®æ ‡çš„ç±»åˆ«å’Œæ¡†çš„ä½ç½®ï¼Œç½‘ç»œç»“æ„å¦‚å›¾ï¼šè¿™é‡Œæˆ‘ç†è§£å°±æ˜¯åœ¨ç½‘ç»œæå®Œç‰¹å¾åå†åŠ ä¸€å±‚ï¼Œç”¨äºé€‰å‡ºå€™é€‰åŒºåŸŸã€‚å¯¹å·ç§¯å¾—åˆ°çš„ $H\\times W$ çš„feature mapï¼Œç”¨ä¸€ä¸ª $n \\times n$ çš„æ»‘åŠ¨çª—å£å¯¹æ¯ä¸ªçª—å£çš„ä¸­å¿ƒç‚¹æ$k$ä¸ªanchorsï¼Œå–3ä¸ªé•¿å®½æ¯”ï¼Œ3ä¸ªç¼©æ”¾æ¯”ï¼Œå³$k=9$ï¼Œå¯¹è¯¥feature mapï¼Œä¼šç”Ÿæˆ $k \\times H \\times W$ ä¸ªanchors ï¼Œå¯¹æ¯ä¸ªanchorçš„ $cls$ åˆ†æ”¯ï¼Œç”¨ä¸€ä¸ª $score$ åˆ¤æ–­è¿™ä¸ªanchoræ˜¯å‰æ™¯è¿˜æ˜¯èƒŒæ™¯ï¼Œæ‰€ä»¥ $score$ çš„æ•°é‡æ˜¯ $2k$ ï¼›å¯¹ $reg$ åˆ†æ”¯ï¼Œéœ€è¦åˆ¤æ–­æ¡†çš„ä½ç½®ï¼Œæ‰€ä»¥ä¿å­˜æ¯ä¸ªanchorçš„ä½ç½®ä¿¡æ¯ï¼ˆå·¦ä¸‹å’Œå³ä¸Šçš„åæ ‡ï¼Œè¿™é‡Œæœ‰æ­§ä¹‰ï¼Œå¥½å¤šåšå®¢é‡Œå†™çš„éƒ½æ˜¯å·¦ä¸Šå³ä¸‹ï¼Œä½†å®é™…ç”»å›¾ç¬¬ä¸€ä¸ªç‚¹æ˜¯å·¦ä¸‹çš„åæ ‡ï¼‰ï¼Œæ‰€ä»¥ $coordinates$ çš„æ•°é‡æ˜¯ $4k$ ã€‚ ç›¸æ¯”äºSSï¼ŒRPNçš„ä¼˜åŠ¿ä¸Šé¢è¯´è¿‡anchorï¼Œç”¨anchorçš„è¯ï¼Œå°±ç›¸å½“äºï¼Œå…ˆçŸ¥é“å¤§è‡´ä½ç½®ï¼Œå†çŸ¥é“å…·ä½“ä½ç½®ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œanchorå°±æ˜¯å…ˆä¸Šè¿™ä¸ªåŒºåŸŸçœ‹ä¸€çœ¼æ˜¯å•¥ï¼Œæ¯”å¦‚ä¸€ä¸ªanchoråŒºåŸŸé‡Œçœ‹è§äº†ä¸€ä¸ªé©¬èº«å­ï¼ˆé©¬å¤´ä¸€éƒ¨åˆ†ä¸åœ¨åŒºåŸŸé‡Œé¢ï¼‰ï¼Œç„¶åå†çœ‹åˆ°çš„é©¬èº«å­çŒœæµ‹ä¸€ä¸‹è¿™ä¸ªç‰©ä½“çš„ä½ç½®ã€‚ä½†ç©·ä¸¾æœç´¢å°±ä¸æ˜¯ï¼Œé©¬èº«å­çš„è¿™ä¸ªåŒºåŸŸä¸æ˜¯ä¸€ä¸ªé©¬çš„åŒºåŸŸï¼Œå¿…é¡»å¾—å»æœç´¢è¿™ä¸ªåŒºåŸŸï¼Œç›´åˆ°è¿™ä¸ªåŒºåŸŸåŒ…å«æ•´ä¸ªé©¬ã€‚rpnçš„ä¼˜ç‚¹å°±æ˜¯ä½ èƒ½ç”¨ç¥ç»ç½‘ç»œå»ä»ä¸€ä¸ªå›¾åƒåŒºåŸŸæ‹Ÿåˆå‡ºç›®æ ‡çš„ä½ç½®æ¥ï¼Œè¿™åœ¨éç¥ç»ç½‘ç»œæ–¹æ³•ä¸Šè‚¯å®šä¸èƒ½ç”¨ã€‚å› ä¸ºç¥ç»ç½‘ç»œæ˜¯ä¸€ä¸ªå¤æ‚çš„éçº¿æ€§å‡½æ•°ï¼Œä¼ ç»Ÿçš„æ–¹æ³•å¹¶ä¸èƒ½è½»æ˜“çš„åšå‡ºå¤æ‚å‡½æ•°æ¥ã€‚è™½ç„¶ä¼ ç»Ÿçš„æ–¹æ³•ä¹Ÿèƒ½æ‹Ÿåˆå¤æ‚å‡½æ•°ï¼Œå¦‚svmã€‚ä¸è¿‡ä¼ ç»Ÿæ–¹æ³•å¾ˆå¤šéƒ½æ˜¯æ¨¡æ¿åŒ¹é…ç±»çš„æ–¹æ³•ï¼Œåªèƒ½è®°ä½è®­ç»ƒå›¾ç‰‡ä¸­çš„æ•´ä½“ç‰¹å¾ã€‚ç¥ç»ç½‘ç»œæ˜¯å±‚çº§ç‰¹å¾æå–çš„ï¼Œåœ¨å›¾åƒä¸Šæ›´åŠ ç¬¦åˆç‰¹ç‚¹ã€‚ä¾‹å¦‚è¯†åˆ«è‡ªè¡Œè½¦ï¼Œsvmæ–¹æ³•å°±æ˜¯æŠŠè®­ç»ƒå›¾åƒçš„è‡ªè¡Œè½¦éƒ½è®°ä½ å¦‚æœæ–°æ¥ä¸€è¾†è½¦ï¼Œå’Œè¿™äº›ç‰¹ç‚¹ä¸å¤ªç›¸åŒï¼Œsvmå°±æŒ‚äº†ã€‚ä½†ç¥ç»ç½‘ç»œä¸åŒï¼Œæ–¹å¼å€¾å‘äºè®­ç»ƒå‡ºè½¦æŠŠå’Œè½¦è½®å­ç­‰çš„æ£€æµ‹å™¨ï¼Œå†å¯¹éƒ¨ä»¶è¿›è¡Œç»„åˆã€‚æ‰€ä»¥rpnä¸­è®­ç»ƒçš„ä¸œè¥¿å°±æ˜¯ä¸€äº›æ ¹æ®åº•å±‚å¾—åˆ°çš„éƒ¨ä»¶æ£€æµ‹å™¨æ¨æµ‹ç‰©ä½“ä½ç½®çš„ä¸€ä¸ªå‡½æ•°ã€‚ä»¥ä¸Šå†…å®¹æ¥è‡ªäºè€å¸ˆç»™æˆ‘çš„è®²è§£ï¼Œçœ‹å®Œäº†ä¹Ÿå°±èƒ½ç†è§£çš„å·®ä¸å¤šäº†ï¼ŒRPNçš„ä½œç”¨æ›´åƒæ˜¯äººçš„æ„Ÿè§‰ä¸€æ ·çš„ç½‘ç»œï¼Œè¿™ä¹ˆè¯´å¯èƒ½ä¸å¤ªåˆé€‚ï¼Œæ¯”å¦‚çœ‹ä¸€è¾†è‡ªè¡Œè½¦ï¼Œäººå¯èƒ½åªçœ‹åˆ°ä¸€éƒ¨åˆ†ï¼Œå‰è½®æˆ–åè½®ï¼Œå°±èƒ½çŸ¥é“è¿™æ˜¯ä¸€è¾†è‡ªè¡Œè½¦äº†ï¼Œè€ŒRPNçš„ä½œç”¨æ­£æ˜¯å¦‚æ­¤ï¼Œæ‰€ä»¥RPNå¯ä»¥é€‰å‡ºæ›´å°‘çš„region proposalè€Œä¸”æ›´åŠ å‡†ç¡®ï¼Œanchoræ˜¯åœ¨é€‰å¥½region proposalçš„åŸºç¡€ä¸Šï¼Œç”¨ä¸åŒé•¿å®½æ¯”çš„ä¸åŒå°ºåº¦èƒ½å»å°½é‡çš„æŠŠè¿™ä¸ªç‰©ä½“åŒ…è¿›å»ã€‚ Share featuresé‡‡ç”¨4æ­¥äº¤æ›¿è®­ç»ƒçš„æ–¹æ³•ï¼š ç”¨ä¸€ä¸ªImageNeté¢„è®­ç»ƒæ¨¡å‹å¯¹RPNç½‘ç»œåšfinetuneï¼ˆRPNçš„ä½œç”¨åœ¨ä¸Šé¢è¯´è¿‡ï¼Œè¿™é‡Œfinetuneçš„ç›®çš„æ˜¯ä¸ºäº†ç”Ÿæˆæ›´å¥½çš„region proposalï¼‰ï¼› ç”¨ç¬¬ä¸€æ­¥å¾—åˆ°çš„region proposalå•ç‹¬çš„è®­ç»ƒä¸€ä¸ªFast RCNNï¼ˆFast RCNNçš„å‚æ•°ä¹Ÿç”±ImageNetçš„ä¸è®­ç»ƒæ¨¡å‹åˆå§‹åŒ–ï¼Œä½†è¿™é‡Œä¸å…±äº«å‚æ•°ï¼‰ï¼› ä½¿ç”¨ç¬¬2æ­¥è®­ç»ƒå¥½çš„Fast RCNNæ¨¡å‹åšé¢„è®­ç»ƒæ¨¡å‹ï¼Œå›ºå®šRPNå±‚ä»¥å¤–çš„å‚æ•°ï¼Œåªå¯¹RPNå±‚åšfinetuneï¼Œè¿™é‡Œå·²ç»å¼€å§‹å…±äº«å·ç§¯å±‚äº†ï¼› æœ€åä¸€æ­¥ï¼Œå›ºå®šå…±äº«å·ç§¯å±‚çš„å‚æ•°ï¼Œå¯¹fast RCNNéƒ¨åˆ†åšfinetuneï¼Œè‡³æ­¤ï¼Œæ•´ä¸ªfaster RCNNè®­ç»ƒå®Œæˆã€‚","link":"/2019/04/29/Faster RCNNè®ºæ–‡é˜…è¯»/"}],"tags":[{"name":"C++","slug":"C","link":"/tags/C/"},{"name":"thread","slug":"thread","link":"/tags/thread/"},{"name":"algorithm","slug":"algorithm","link":"/tags/algorithm/"},{"name":"git","slug":"git","link":"/tags/git/"},{"name":"python","slug":"python","link":"/tags/python/"},{"name":"paper","slug":"paper","link":"/tags/paper/"},{"name":"RPN","slug":"RPN","link":"/tags/RPN/"},{"name":"Faster RCNN","slug":"Faster-RCNN","link":"/tags/Faster-RCNN/"}],"categories":[{"name":"C++","slug":"C","link":"/categories/C/"},{"name":"Leetcode","slug":"Leetcode","link":"/categories/Leetcode/"},{"name":"else","slug":"else","link":"/categories/else/"},{"name":"paper","slug":"paper","link":"/categories/paper/"}]}