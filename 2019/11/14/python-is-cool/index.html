<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">

<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
    if (history.length === 1) {
        window.opener = null;
        window.open('', '_self');
        window.close();
                } else {
                    history.back();
                }
            }
        }
    })();
</script>








<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="python,">





  <link rel="alternate" href="/atom.xml" title="Junyuan's blog" type="application/atom+xml">






<meta name="description" content="沈阳下雪了。">
<meta name="keywords" content="python">
<meta property="og:type" content="article">
<meta property="og:title" content="A gentle guide to the Python features">
<meta property="og:url" content="http://www.junyuanw.com/2019/11/14/python-is-cool/index.html">
<meta property="og:site_name" content="Junyuan&#39;s blog">
<meta property="og:description" content="沈阳下雪了。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-08-09T11:08:27.696Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A gentle guide to the Python features">
<meta name="twitter:description" content="沈阳下雪了。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.junyuanw.com/2019/11/14/python-is-cool/">





  <title>A gentle guide to the Python features | Junyuan's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <a href="https://github.com/Junyuan12" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Junyuan's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.junyuanw.com/2019/11/14/python-is-cool/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Junyuan Wang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Junyuan's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">A gentle guide to the Python features</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>

              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-11-14T20:01:48+08:00">
                2019-11-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>沈阳下雪了。</p>
 <a id="more"></a>
<p>原文地址：<a href="https://github.com/chiphuyen/python-is-cool" target="_blank" rel="noopener">github</a></p>
<h2 id="Lambda-map-filter-reduce"><a href="#Lambda-map-filter-reduce" class="headerlink" title="Lambda, map, filter, reduce"></a>Lambda, map, filter, reduce</h2><p>The lambda keyword is used to create inline functions. The functions<code>square_fn</code> and <code>square_ld</code> below are identical.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">square_fn</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x * x</span><br><span class="line"></span><br><span class="line">square_ld = <span class="keyword">lambda</span> x: x * x</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">assert</span> square_fn(i) == square_ld(i)</span><br></pre></td></tr></table></figure>
<p>Its quick declaration makes <code>lambda</code> functions ideal for use in callbacks, and when functions are to be passed as arguments to other functions. They are especially useful when used in conjunction with functions like <code>map</code>, <code>filter</code>, and <code>reduce</code>.</p>
<p><code>map(fn, iterable)</code> applies the <code>fn</code> to all elements of the <code>iterable</code> (e.g. list, set, dictionary, tuple, string) and returns a map object.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nums = [<span class="number">1</span>/<span class="number">3</span>, <span class="number">333</span>/<span class="number">7</span>, <span class="number">2323</span>/<span class="number">2230</span>, <span class="number">40</span>/<span class="number">34</span>, <span class="number">2</span>/<span class="number">3</span>]</span><br><span class="line">nums_squared = [num * num <span class="keyword">for</span> num <span class="keyword">in</span> nums]</span><br><span class="line">print(nums_squared)</span><br><span class="line"></span><br><span class="line">==&gt; [0.1111111, 2263.04081632, 1.085147, 1.384083, 0.44444444]</span><br></pre></td></tr></table></figure>
<p>This is the same as calling using <code>map</code> with a callback function.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nums_squared_1 = map(square_fn, nums)</span><br><span class="line">nums_squared_2 = map(<span class="keyword">lambda</span> x: x * x, nums)</span><br><span class="line">print(list(nums_squared_1))</span><br><span class="line"></span><br><span class="line">==&gt; [0.1111111, 2263.04081632, 1.085147, 1.384083, 0.44444444]</span><br></pre></td></tr></table></figure>
<p>You can also use <code>map</code> with more than one iterable. For example, if you want to calculate the mean squared error of a simple linear function <code>f(x) = ax + b</code> with the true label <code>labels</code>, these two methods are equivalent:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">a, b = <span class="number">3</span>, <span class="number">-0.5</span></span><br><span class="line">xs = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">labels = [<span class="number">6.4</span>, <span class="number">8.9</span>, <span class="number">10.9</span>, <span class="number">15.3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Method 1: using a loop</span></span><br><span class="line">errors = []</span><br><span class="line"><span class="keyword">for</span> i, x <span class="keyword">in</span> enumerate(xs):</span><br><span class="line">    errors.append((a * x + b - labels[i]) ** <span class="number">2</span>)</span><br><span class="line">result1 = sum(errors) ** <span class="number">0.5</span> / len(xs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Method 2: using map</span></span><br><span class="line">diffs = map(<span class="keyword">lambda</span> x, y: (a * x + b - y) ** <span class="number">2</span>, xs, labels)</span><br><span class="line">result2 = sum(diffs) ** <span class="number">0.5</span> / len(xs)</span><br><span class="line"></span><br><span class="line">print(result1, result2)</span><br><span class="line"></span><br><span class="line">==&gt; 0.35089172119045514 0.35089172119045514</span><br></pre></td></tr></table></figure>
<p>Note that objects returned by <code>map</code> and <code>filter</code> are iterators, which means that their values aren’t stored but generated as needed. After you’ve called <code>sum(diffs)</code>, <code>diffs</code> becomes empty. If you want to keep all elements in <code>diffs</code>, convert it to a list using <code>list(diffs)</code>.</p>
<p><code>filter(fn, iterable)</code> works the same way as <code>map</code>, except that <code>fn</code> returns a boolean value and <code>filter</code> returns all the elements of the <code>iterable</code> for which the <code>fn</code> returns True.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bad_preds = filter(<span class="keyword">lambda</span> x: x &gt; <span class="number">0.5</span>, errors)</span><br><span class="line">print(list(bad_preds))</span><br><span class="line"></span><br><span class="line">==&gt; [0.8100000000000006, 0.6400000000000011]</span><br></pre></td></tr></table></figure>
<p><code>reduce(fn, iterable, initializer)</code> is used when we want to iteratively apply an operator to all elements in a list. For example, if we want to calculate the product of all elements in a list:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">product = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> nums:</span><br><span class="line">    product *= num</span><br><span class="line">print(product)</span><br><span class="line"></span><br><span class="line">==&gt; 12.95564683272412</span><br></pre></td></tr></table></figure>
<p>This is equivalent to:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">product = reduce(<span class="keyword">lambda</span> x, y: x * y, nums)</span><br><span class="line">print(product)</span><br><span class="line"></span><br><span class="line">==&gt; 12.95564683272412</span><br></pre></td></tr></table></figure></p>
<p><strong>Note on the performance of lambda functions</strong></p>
<p>Lambda functions are meant for one time use. Each time <code>lambda x: dosomething(x)</code> is called, the function has to be created, which hurts the performance if you call <code>lambda x: dosomething(x)</code> multiple times (e.g. when you pass it inside <code>reduce</code>).</p>
<p>When you assign a name to the lambda function as in <code>fn = lambda x: dosomething(x)</code>, its performance is slightly slower than the same function defined using <code>def</code>, but the difference is negligible. See <a href="https://stackoverflow.com/questions/26540885/lambda-is-slower-than-function-call-in-python-why" target="_blank" rel="noopener">here</a>.</p>
<p>Even though I find lambdas cool, I personally recommend using named functions when you can for the sake of clarity.</p>
<h2 id="List-manipulation"><a href="#List-manipulation" class="headerlink" title="List manipulation"></a>List manipulation</h2><p>Python lists are super cool.</p>
<h3 id="Unpacking"><a href="#Unpacking" class="headerlink" title="Unpacking"></a>Unpacking</h3><p>We can unpack a list by each element like this:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">elems = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">a, b, c, d = elems</span><br><span class="line">print(a, b, c, d)</span><br><span class="line"></span><br><span class="line">==&gt; 1 2 3 4</span><br></pre></td></tr></table></figure></p>
<p>We can also unpack a list like this:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a, *new_elems, d = elems</span><br><span class="line">print(a)</span><br><span class="line">print(new_elems)</span><br><span class="line">print(d)</span><br><span class="line"></span><br><span class="line">==&gt; 1</span><br><span class="line">    [<span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">    <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h3 id="Slicing"><a href="#Slicing" class="headerlink" title="Slicing"></a>Slicing</h3><p>We know that we can reverse a list using <code>[::-1]</code>.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">elems = list(range(<span class="number">10</span>))</span><br><span class="line">print(elems)</span><br><span class="line"></span><br><span class="line">==&gt; [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line"></span><br><span class="line">print(elems[::<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line">==&gt; [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]</span><br></pre></td></tr></table></figure>
<p>The syntax <code>[x:y:z]</code> means \”take every <code>z</code>th element of a list from index <code>x</code> to index <code>y</code>\”. When <code>z</code> is negative, it indicates going backwards. When <code>x</code> isn’t specified, it defaults to the first element of the list in the direction you are traversing the list. When <code>y</code> isn’t specified, it defaults to the last element of the list. So if we want to take every 2th element of a list, we use <code>[::2]</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">evens = elems[::<span class="number">2</span>]</span><br><span class="line">print(evens)</span><br><span class="line"></span><br><span class="line">reversed_evens = elems[<span class="number">-2</span>::<span class="number">-2</span>]</span><br><span class="line">print(reversed_evens)</span><br><span class="line"></span><br><span class="line">==&gt; [0, 2, 4, 6, 8]</span><br><span class="line">    [<span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<p>We can also use slicing to delete all the even numbers in the list.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> elems[::<span class="number">2</span>]</span><br><span class="line">print(elems)</span><br><span class="line"></span><br><span class="line">==&gt; [1, 3, 5, 7, 9]</span><br></pre></td></tr></table></figure>
<h3 id="Insertion"><a href="#Insertion" class="headerlink" title="Insertion"></a>Insertion</h3><p>We can change the value of an element in a list to another value.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">elems = list(range(<span class="number">10</span>))</span><br><span class="line">elems[<span class="number">1</span>] = <span class="number">10</span></span><br><span class="line">print(elems)</span><br><span class="line"></span><br><span class="line">==&gt; [0, 10, 2, 3, 4, 5, 6, 7, 8, 9]</span><br></pre></td></tr></table></figure>
<p>If we want to replace the element at an index with multiple elements, e.g. replace the value <code>1</code> with 3 values <code>20, 30, 40</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">elems = list(range(<span class="number">10</span>))</span><br><span class="line">elems[<span class="number">1</span>:<span class="number">2</span>] = [<span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>]</span><br><span class="line">print(elems)</span><br><span class="line"></span><br><span class="line">==&gt; [0, 20, 30, 40, 2, 3, 4, 5, 6, 7, 8, 9]</span><br></pre></td></tr></table></figure>
<p>If we want to insert 3 values <code>0.2, 0.3, 0.5</code> between element at index 0 and element at index 1:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">elems = list(range(<span class="number">10</span>))</span><br><span class="line">elems[<span class="number">1</span>:<span class="number">1</span>] = [<span class="number">0.2</span>, <span class="number">0.3</span>, <span class="number">0.5</span>]</span><br><span class="line">print(elems)</span><br><span class="line"></span><br><span class="line">==&gt; [0, 0.2, 0.3, 0.5, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br></pre></td></tr></table></figure>
<h3 id="Flattening"><a href="#Flattening" class="headerlink" title="Flattening"></a>Flattening</h3><p>We can flatten a list of lists using <code>sum</code>.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list_of_lists = [[<span class="number">1</span>], [<span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]]</span><br><span class="line">sum(list_of_lists, [])</span><br><span class="line"></span><br><span class="line">==&gt; [1, 2, 3, 4, 5, 6]</span><br></pre></td></tr></table></figure>
<p>If we have nested lists, we can recursively flatten it. That’s another beauty of lambda functions — we can use it in the same line as its creation.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nested_lists = [[<span class="number">1</span>, <span class="number">2</span>], [[<span class="number">3</span>, <span class="number">4</span>], [<span class="number">5</span>, <span class="number">6</span>], [[<span class="number">7</span>, <span class="number">8</span>], [<span class="number">9</span>, <span class="number">10</span>], [[<span class="number">11</span>, [<span class="number">12</span>, <span class="number">13</span>]]]]]]</span><br><span class="line">flatten = <span class="keyword">lambda</span> x: [y <span class="keyword">for</span> l <span class="keyword">in</span> x <span class="keyword">for</span> y <span class="keyword">in</span> flatten(l)] <span class="keyword">if</span> type(x) <span class="keyword">is</span> list <span class="keyword">else</span> [x]</span><br><span class="line">flatten(nested_lists)</span><br><span class="line"></span><br><span class="line"><span class="comment"># This line of code is from</span></span><br><span class="line"><span class="comment"># https://github.com/sahands/python-by-example/blob/master/python-by-example.rst#flattening-lists</span></span><br></pre></td></tr></table></figure>
<h3 id="List-vs-generator"><a href="#List-vs-generator" class="headerlink" title="List vs generator"></a>List vs generator</h3><p>To illustrate the difference between a list and a generator, let’s look at an example of creating n-grams out of a list of tokens.</p>
<p>One way to create n-grams is to use a sliding window.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">tokens = [<span class="string">'i'</span>, <span class="string">'want'</span>, <span class="string">'to'</span>, <span class="string">'go'</span>, <span class="string">'to'</span>, <span class="string">'school'</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ngrams</span><span class="params">(tokens, n)</span>:</span></span><br><span class="line">    length = len(tokens)</span><br><span class="line">    grams = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(length - n + <span class="number">1</span>):</span><br><span class="line">        grams.append(tokens[i:i+n])</span><br><span class="line">    <span class="keyword">return</span> grams</span><br><span class="line"></span><br><span class="line">print(ngrams(tokens, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">==&gt; [['i', 'want', 'to'],</span><br><span class="line">     [<span class="string">'want'</span>, <span class="string">'to'</span>, <span class="string">'go'</span>],</span><br><span class="line">     [<span class="string">'to'</span>, <span class="string">'go'</span>, <span class="string">'to'</span>],</span><br><span class="line">     [<span class="string">'go'</span>, <span class="string">'to'</span>, <span class="string">'school'</span>]]</span><br></pre></td></tr></table></figure>
<p>In the above example, we have to store all the n-grams at the same time. If the text has m tokens, then the memory requirement is <code>O(nm)</code>, which can be problematic when m is large.</p>
<p>Instead of using a list to store all n-grams, we can use a generator that generates the next n-gram when it’s asked for. This is known as lazy evaluation. We can make the function <code>ngrams</code> returns a generator using the keyword <code>yield</code>. Then the memory requirement is <code>O(m+n)</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ngrams</span><span class="params">(tokens, n)</span>:</span></span><br><span class="line">    length = len(tokens)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(length - n + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">yield</span> tokens[i:i+n]</span><br><span class="line"></span><br><span class="line">ngrams_generator = ngrams(tokens, <span class="number">3</span>)</span><br><span class="line">print(ngrams_generator)</span><br><span class="line"></span><br><span class="line">==&gt; &lt;generator object ngrams at 0x1069b26d0&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ngram <span class="keyword">in</span> ngrams_generator:</span><br><span class="line">    print(ngram)</span><br><span class="line"></span><br><span class="line">==&gt; ['i', 'want', 'to']</span><br><span class="line">    [<span class="string">'want'</span>, <span class="string">'to'</span>, <span class="string">'go'</span>]</span><br><span class="line">    [<span class="string">'to'</span>, <span class="string">'go'</span>, <span class="string">'to'</span>]</span><br><span class="line">    [<span class="string">'go'</span>, <span class="string">'to'</span>, <span class="string">'school'</span>]</span><br></pre></td></tr></table></figure>
<p>Another way to generate n-grams is to use slices to create lists: <code>[0, 1, ..., -n]</code>, <code>[1, 2, ..., -n+1]</code>, …, <code>[n-1, n, ..., -1]</code>, and then <code>zip</code> them together.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ngrams</span><span class="params">(tokens, n)</span>:</span></span><br><span class="line">    length = len(tokens)</span><br><span class="line">    slices = (tokens[i:length-n+i+<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(n))</span><br><span class="line">    <span class="keyword">return</span> zip(*slices)</span><br><span class="line"></span><br><span class="line">ngrams_generator = ngrams(tokens, <span class="number">3</span>)</span><br><span class="line">print(ngrams_generator)</span><br><span class="line"></span><br><span class="line">==&gt; &lt;zip object at 0x1069a7dc8&gt; # zip objects are generators</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ngram <span class="keyword">in</span> ngrams_generator:</span><br><span class="line">    print(ngram)</span><br><span class="line"></span><br><span class="line">==&gt; ('i', 'want', 'to')</span><br><span class="line">    (<span class="string">'want'</span>, <span class="string">'to'</span>, <span class="string">'go'</span>)</span><br><span class="line">    (<span class="string">'to'</span>, <span class="string">'go'</span>, <span class="string">'to'</span>)</span><br><span class="line">    (<span class="string">'go'</span>, <span class="string">'to'</span>, <span class="string">'school'</span>)</span><br></pre></td></tr></table></figure>
<p>Note that to create slices, we use <code>(tokens[...] for i in range(n))</code> instead of <code>[tokens[...] for i in range(n)]</code>. <code>[]</code> is the normal list comprehension that returns a list. <code>()</code> returns a generator.</p>
<h2 id="Classes-and-magic-methods"><a href="#Classes-and-magic-methods" class="headerlink" title="Classes and magic methods"></a>Classes and magic methods</h2><p>In Python, magic methods are prefixed and suffixed with the double underscore <code>__</code>, also known as dunder. The most wellknown magic method is probably <code>__init__</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span>:</span></span><br><span class="line">    <span class="string">""" A struct to denote the node of a binary tree.</span></span><br><span class="line"><span class="string">    It contains a value and pointers to left and right children.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, value, left=None, right=None)</span>:</span></span><br><span class="line">        self.value = value</span><br><span class="line">        self.left = left</span><br><span class="line">        self.right = right</span><br></pre></td></tr></table></figure>
<p>When we try to print out a Node object, however, it’s not very interpretable.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root = Node(<span class="number">5</span>)</span><br><span class="line">print(root) <span class="comment"># &lt;__main__.Node object at 0x1069c4518&gt;</span></span><br></pre></td></tr></table></figure>
<p>Ideally, when user prints out a node, we want to print out the node’s value and the values of its children if it has children. To do so, we use the magic method <code>__repr__</code>, which must return a printable object, like string.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span>:</span></span><br><span class="line">    <span class="string">""" A struct to denote the node of a binary tree.</span></span><br><span class="line"><span class="string">    It contains a value and pointers to left and right children.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, value, left=None, right=None)</span>:</span></span><br><span class="line">        self.value = value</span><br><span class="line">        self.left = left</span><br><span class="line">        self.right = right</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        strings = [<span class="string">f'value: <span class="subst">&#123;self.value&#125;</span>'</span>]</span><br><span class="line">        strings.append(<span class="string">f'left: <span class="subst">&#123;self.left.value&#125;</span>'</span> <span class="keyword">if</span> self.left <span class="keyword">else</span> <span class="string">'left: None'</span>)</span><br><span class="line">        strings.append(<span class="string">f'right: <span class="subst">&#123;self.right.value&#125;</span>'</span> <span class="keyword">if</span> self.right <span class="keyword">else</span> <span class="string">'right: None'</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">', '</span>.join(strings)</span><br><span class="line"></span><br><span class="line">left = Node(<span class="number">4</span>)</span><br><span class="line">root = Node(<span class="number">5</span>, left)</span><br><span class="line">print(root) <span class="comment"># value: 5, left: 4, right: None</span></span><br></pre></td></tr></table></figure>
<p>We’d also like to compare two nodes by comparing their values. To do so, we overload the operator <code>==</code> with <code>__eq__</code>, <code>&lt;</code> with <code>__lt__</code>, and <code>&gt;=</code> with <code>__ge__</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span>:</span></span><br><span class="line">    <span class="string">""" A struct to denote the node of a binary tree.</span></span><br><span class="line"><span class="string">    It contains a value and pointers to left and right children.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, value, left=None, right=None)</span>:</span></span><br><span class="line">        self.value = value</span><br><span class="line">        self.left = left</span><br><span class="line">        self.right = right</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.value == other.value</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.value &lt; other.value</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__ge__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.value &gt;= other.value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">left = Node(<span class="number">4</span>)</span><br><span class="line">root = Node(<span class="number">5</span>, left)</span><br><span class="line">print(left == root) <span class="comment"># False</span></span><br><span class="line">print(left &lt; root) <span class="comment"># True</span></span><br><span class="line">print(left &gt;= root) <span class="comment"># False</span></span><br></pre></td></tr></table></figure>
<p>For a comprehensive list of supported magic methods <a href="https://www.tutorialsteacher.com/python/magic-methods-in-python" target="_blank" rel="noopener">here</a> or see the official Python documentation <a href="https://docs.python.org/3/reference/datamodel.html#special-method-names" target="_blank" rel="noopener">here</a> (slightly harder to read).</p>
<p>Some of the methods that I highly recommend:</p>
<ul>
<li><code>__len__</code>: to overload the <code>len()</code> function.</li>
<li><code>__str__</code>: to overload the <code>str()</code> function.</li>
<li><code>__iter__</code>: if you want to your objects to be iterators. This also allows you to call <code>next()</code> on your object.</li>
</ul>
<p>For classes like Node where we know for sure all the attributes they can support (in the case of Node, they are <code>value</code>, <code>left</code>, and <code>right</code>), we might want to use <code>__slots__</code> to denote those values for both performance boost and memory saving. For a comprehensive understanding of pros and cons of <code>__slots__</code>, see this <a href="https://stackoverflow.com/a/28059785/5029595" target="_blank" rel="noopener">absolutely amazing answer by Aaron Hall on StackOverflow</a>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span>:</span></span><br><span class="line">    <span class="string">""" A struct to denote the node of a binary tree.</span></span><br><span class="line"><span class="string">    It contains a value and pointers to left and right children.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    __slots__ = (<span class="string">'value'</span>, <span class="string">'left'</span>, <span class="string">'right'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, value, left=None, right=None)</span>:</span></span><br><span class="line">        self.value = value</span><br><span class="line">        self.left = left</span><br><span class="line">        self.right = right</span><br></pre></td></tr></table></figure>
<h2 id="local-namespace-object’s-attributes"><a href="#local-namespace-object’s-attributes" class="headerlink" title="local namespace, object’s attributes"></a>local namespace, object’s attributes</h2><p>The <code>locals()</code> function returns a dictionary containing the variables defined in the local namespace.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model1</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, hidden_size=<span class="number">100</span>, num_layers=<span class="number">3</span>, learning_rate=<span class="number">3e-4</span>)</span>:</span></span><br><span class="line">        print(locals())</span><br><span class="line">        self.hidden_size = hidden_size</span><br><span class="line">        self.num_layers = num_layers</span><br><span class="line">        self.learning_rate = learning_rate</span><br><span class="line"></span><br><span class="line">model1 = Model1()</span><br><span class="line"></span><br><span class="line">==&gt; &#123;'learning_rate': 0.0003, 'num_layers': 3, 'hidden_size': 100, 'self': &lt;__main__.Model1 object at 0x1069b1470&gt;&#125;</span><br></pre></td></tr></table></figure>
<p>All attributes of an object are stored in its <code>__dict__</code>.<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(model1.__dict__)</span><br><span class="line"></span><br><span class="line">==&gt; &#123;'hidden_size': 100, 'num_layers': 3, 'learning_rate': 0.0003&#125;</span><br></pre></td></tr></table></figure></p>
<p>Note that manually assigning each of the arguments to an attribute can be quite tiring when the list of the arguments is large. To avoid this, we can directly assign the list of arguments to the object’s <code>__dict__</code>.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model2</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, hidden_size=<span class="number">100</span>, num_layers=<span class="number">3</span>, learning_rate=<span class="number">3e-4</span>)</span>:</span></span><br><span class="line">        params = locals()</span><br><span class="line">        <span class="keyword">del</span> params[<span class="string">'self'</span>]</span><br><span class="line">        self.__dict__ = params</span><br><span class="line"></span><br><span class="line">model2 = Model2()</span><br><span class="line">print(model2.__dict__)</span><br><span class="line"></span><br><span class="line">==&gt; &#123;'learning_rate': 0.0003, 'num_layers': 3, 'hidden_size': 100&#125;</span><br></pre></td></tr></table></figure>
<p>This can be especially convenient when the object is initiated using the catch-all <code>**kwargs</code>, though the use of <code>**kwargs</code> should be reduced to the minimum.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model3</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, **kwargs)</span>:</span></span><br><span class="line">        self.__dict__ = kwargs</span><br><span class="line"></span><br><span class="line">model3 = Model3(hidden_size=<span class="number">100</span>, num_layers=<span class="number">3</span>, learning_rate=<span class="number">3e-4</span>)</span><br><span class="line">print(model3.__dict__)</span><br><span class="line"></span><br><span class="line">==&gt; &#123;'hidden_size': 100, 'num_layers': 3, 'learning_rate': 0.0003&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Wild-import"><a href="#Wild-import" class="headerlink" title="Wild import"></a>Wild import</h2><p>Often, you run into this wild import <code>*</code> that looks something like this:</p>
<p><code>file.py</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> parts <span class="keyword">import</span> *</span><br></pre></td></tr></table></figure></p>
<p>This is irresponsible because it will import everything in module, even the imports of that module. For example, if <code>parts.py</code> looks like this:</p>
<p><code>parts.py</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"><span class="keyword">import</span> tensorflow</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Encoder</span>:</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Decoder</span>:</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Loss</span>:</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">utils</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">    ...</span><br></pre></td></tr></table></figure></p>
<p>Since <code>parts.py</code> doesn’t have <code>__all__</code> specified, <code>file.py</code> will import Encoder, Decoder, Loss, utils, helper together with numpy and tensorflow.</p>
<p>If we intend that only Encoder, Decoder, and Loss are ever to be imported and used in another module, we should specify that in <code>parts.py</code> using the <code>__all__</code> keyword.</p>
<p><code>parts.py</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> __all__ = [<span class="string">'Encoder'</span>, <span class="string">'Decoder'</span>, <span class="string">'Loss'</span>]</span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"><span class="keyword">import</span> tensorflow</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Encoder</span>:</span></span><br><span class="line">    ...</span><br></pre></td></tr></table></figure></p>
<p>Now, if some user irresponsibly does a wild import with <code>parts</code>, they can only import Encoder, Decoder, Loss. Personally, I also find <code>__all__</code> helpful as it gives me an overview of the module.</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" <i class="fa fa-tag"> python</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/11/10/Faster_RCNN_change_categorise_in_train/" rel="next" title="Tensorflow Faster RCNN修改训练的类别数量">
                <i class="fa fa-chevron-left"></i> Tensorflow Faster RCNN修改训练的类别数量
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/08/09/first-month-of-work/" rel="prev" title="入职一个多月">
                入职一个多月 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80NDAwOS8yMDU0NQ=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Junyuan Wang">
            
              <p class="site-author-name" itemprop="name">Junyuan Wang</p>
              <p class="site-description motion-element" itemprop="description">Simple is better than complex. Complex is better than complicated.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">35</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Junyuan12" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/junyuan0912" target="_blank" title="Weibo">
                      
                        <i class="fa fa-fw fa-weibo"></i>Weibo</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:junyuan0912@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Lambda-map-filter-reduce"><span class="nav-number">1.</span> <span class="nav-text">Lambda, map, filter, reduce</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#List-manipulation"><span class="nav-number">2.</span> <span class="nav-text">List manipulation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Unpacking"><span class="nav-number">2.1.</span> <span class="nav-text">Unpacking</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Slicing"><span class="nav-number">2.2.</span> <span class="nav-text">Slicing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Insertion"><span class="nav-number">2.3.</span> <span class="nav-text">Insertion</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Flattening"><span class="nav-number">2.4.</span> <span class="nav-text">Flattening</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#List-vs-generator"><span class="nav-number">2.5.</span> <span class="nav-text">List vs generator</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Classes-and-magic-methods"><span class="nav-number">3.</span> <span class="nav-text">Classes and magic methods</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#local-namespace-object’s-attributes"><span class="nav-number">4.</span> <span class="nav-text">local namespace, object’s attributes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Wild-import"><span class="nav-number">5.</span> <span class="nav-text">Wild import</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart" aria-hidden="true"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Junyuan Wang</span>

  
</div>

<!--
<span class="post-meta-divider">|</span>

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>



-->
        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  


  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
